{
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Glog.AI",
          "organization": "Glog.AI",
          "fullName": "Glog, Making software more secure",
          "version": "1.0.0",
          "semanticVersion": "1.0.0",
          "informationUri": "https://www.glog.ai",
          "rules": [
            {
              "id": "90961217-37f2-37be-84dc-eef19c99fc59",
              "name": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `Math.random()` function in JavaScript is not suitable for generating cryptographic secrets. The random values it produces are predictable, which makes it possible for an attacker to guess the output and compromise the security of the application. This is a form of Cryptographic Weakness, specifically related to the use of Insufficiently Random Values (CWE-330).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should use a function designed to generate cryptographically secure random values. In Node.js, you can use the `crypto.randomBytes()` function, which generates a buffer of cryptographically secure random bytes.\n\n## Code Fix Recommendation\n\nHere is how you can fix the code:\n\n```javascript\nconst crypto = require('crypto');\n\nlet price = parseInt(crypto.randomBytes(4).readUInt32BE(0, true) % 100);\n```\n\nThis code uses the `crypto.randomBytes()` function to generate a buffer of 4 random bytes, then reads those bytes as a 32-bit unsigned integer. The `% 100` operation ensures the result is between 0 and 99, inclusive.\n\n## Library Dependencies\n\nThe code example requires the built-in `crypto` module in Node.js.\n\n## References\n\n- [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [CWE-330: Use of Insufficiently Random Values](https://cwe.mitre.org/data/definitions/330.html)\n\nPlease note that the links provided are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-330",
                    "url": "https://cwe.mitre.org/data/definitions/330.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-330"
                ]
              }
            },
            {
              "id": "31beb584-8207-362f-8d9c-740010883040",
              "name": "URI Contains Username and Password Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe \"URI Contains Username and Password Vulnerability\" is a security issue where sensitive information such as usernames and passwords are included in the URI. This is a bad practice as it exposes these credentials to potential attackers. In JavaScript, this vulnerability can occur when using libraries or functions that allow for the creation of URIs with embedded credentials.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, sensitive information such as usernames and passwords should never be included in the URI. Instead, these credentials should be stored securely and passed to the server in a secure manner, such as through HTTPS and POST methods. \n\n## Source Code Fix Recommendation\n\nInstead of including the username and password in the URI, you can use a library like `pg` to connect to your PostgreSQL database. Here's an example:\n\n```javascript\nconst { Pool } = require('pg');\n\nconst pool = new Pool({\n  user: 'postgres',\n  host: '10.211.55.70',\n  password: 'postgres',\n  database: 'my_database',\n});\n\npool.query('SELECT NOW()', (err, res) => {\n  console.log(err, res);\n  pool.end();\n});\n```\n\n## Library Dependencies\n\nThe code example requires the `pg` library to execute properly.\n\n```bash\nnpm install pg\n```\n\n## References\n\n- [OWASP - Password in Configuration File](https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication)\n- [CWE-259: Use of Hard-coded Password](https://cwe.mitre.org/data/definitions/259.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-259",
                    "url": "https://cwe.mitre.org/data/definitions/259.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-259"
                ]
              }
            },
            {
              "id": "201f005c-dbaa-35bf-9d0a-70aa254a89e1",
              "name": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `Math.random()` function in JavaScript is not suitable for generating cryptographic secrets. The random values it produces are predictable, which makes it possible for an attacker to guess the output and compromise the security of the application. This is a form of Cryptographic Weakness, specifically related to the use of Insufficiently Random Values (CWE-330).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should use a function designed to generate cryptographically secure random values. In Node.js, you can use the `crypto.randomBytes()` function, which generates a buffer of cryptographically secure random bytes.\n\n## Code Fix Recommendation\n\nHere is how you can fix the code:\n\n```javascript\nconst crypto = require('crypto');\n\nlet price = parseInt(crypto.randomBytes(4).readUInt32BE(0, true) % 100);\n```\n\nThis code uses the `crypto.randomBytes()` function to generate a buffer of 4 random bytes, then reads those bytes as a 32-bit unsigned integer. The `% 100` operation ensures the result is between 0 and 99, inclusive.\n\n## Library Dependencies\n\nThe code example requires the built-in `crypto` module in Node.js.\n\n## References\n\n- [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [CWE-330: Use of Insufficiently Random Values](https://cwe.mitre.org/data/definitions/330.html)\n\nPlease note that the links provided are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-330",
                    "url": "https://cwe.mitre.org/data/definitions/330.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-330"
                ]
              }
            },
            {
              "id": "0c6519c5-cb1d-3522-88e6-11de7eb64770",
              "name": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `Math.random()` function in JavaScript is not suitable for generating cryptographic secrets. The random values it produces are predictable, which makes it possible for an attacker to guess the output and compromise the security of the application. This is a form of Cryptographic Weakness, specifically related to the use of Insufficiently Random Values (CWE-330).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should use a function designed to generate cryptographically secure random values. In Node.js, you can use the `crypto.randomBytes()` function, which generates a buffer of cryptographically secure random bytes.\n\n## Code Fix Recommendation\n\nHere is how you can fix the code:\n\n```javascript\nconst crypto = require('crypto');\n\nlet price = parseInt(crypto.randomBytes(4).readUInt32BE(0, true) % 100);\n```\n\nThis code uses the `crypto.randomBytes()` function to generate a buffer of 4 random bytes, then reads those bytes as a 32-bit unsigned integer. The `% 100` operation ensures the result is between 0 and 99, inclusive.\n\n## Library Dependencies\n\nThe code example requires the built-in `crypto` module in Node.js.\n\n## References\n\n- [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [CWE-330: Use of Insufficiently Random Values](https://cwe.mitre.org/data/definitions/330.html)\n\nPlease note that the links provided are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-330",
                    "url": "https://cwe.mitre.org/data/definitions/330.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-330"
                ]
              }
            },
            {
              "id": "ef867e0a-cae2-3a7d-8b4c-e8b3ed3a5d6a",
              "name": "High-Risk Dockerfile Vulnerability: Improper Use of MAINTAINER Directive",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `MAINTAINER` directive in a Dockerfile is used to set the Author field of the generated images. It is not a high-risk vulnerability, but it is considered a bad practice. The `MAINTAINER` directive is deprecated since Docker version 1.13.0. Instead, you should use the `LABEL` directive with the `maintainer` key.\n\n## Security Concern\n\nThe main security concern with the `MAINTAINER` directive is not a direct vulnerability, but rather a matter of maintainability and transparency. If the maintainer of the Docker image changes, or if the contact information becomes outdated, it can lead to confusion and difficulty in addressing potential security issues or updates. \n\n## Mitigation Advice\n\nTo mitigate this, it is recommended to use the `LABEL` directive instead of the `MAINTAINER` directive. The `LABEL` directive allows you to specify multiple metadata in a single layer, and it is more flexible and less likely to become outdated.\n\n## Source Code Fix Recommendation\n\nReplace the `MAINTAINER` directive with the `LABEL` directive:\n\n```Dockerfile\nLABEL maintainer=\"Daniel Garcia aka (cr0hn) <cr0hn@cr0hn.com>\"\n```\n\n## Library Dependencies\n\nThere are no library dependencies required by the code example to execute properly.\n\n## References\n\n\n- [CWE-200: Information Exposure](https://cwe.mitre.org/data/definitions/200.html)\n\nPlease note that there is no direct CWE for the misuse of the `MAINTAINER` directive in Dockerfile. The closest match is CWE-200, which is a general category for Information Exposure."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-200",
                    "url": "https://cwe.mitre.org/data/definitions/200.html"
                  }
                ],
                "severity": "HIGH",
                "kind": "FAIL",
                "tags": [
                  "CWE-200"
                ]
              }
            },
            {
              "id": "beccad8a-68ff-3625-8af6-43e6f5112e1f",
              "name": "\"Missing CSRF Middleware in Express Application\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nCross-Site Request Forgery (CSRF) is a type of attack that occurs when a malicious web site, email, blog, instant message, or program causes a user's web browser to perform an unwanted action on a trusted site for which the user is currently authenticated. \n\nIn Express.js applications, if CSRF middleware is not implemented, it leaves the application vulnerable to CSRF attacks. This is because without CSRF protection, the application cannot verify whether incoming requests are made by legitimate users or by attackers who have tricked users into executing actions on their behalf.\n\n## Mitigation Advice\n\nTo mitigate CSRF vulnerabilities, you should use CSRF protection middleware in your Express.js application. This middleware adds a CSRF token to every session, which must be included in every state-changing operation. This token ensures that the user making the request is the one who initiated it.\n\n## Source Code Fix Recommendation\n\nYou can use the `csurf` middleware for CSRF protection in Express.js applications. Here is how you can implement it:\n\n```javascript\nvar express = require('express');\nvar cookieParser = require('cookie-parser');\nvar csrf = require('csurf');\n\nvar csrfProtection = csrf({ cookie: true });\nvar app = express();\n\napp.use(cookieParser());\n\n// Apply CSRF protection to all subsequent routes\napp.use(csrfProtection);\n\napp.get('/form', function(req, res) {\n  // pass the csrfToken to the view\n  res.render('send', { csrfToken: req.csrfToken() });\n});\n```\n\nIn this example, `cookie-parser` is used to read cookies, which is needed by `csurf`.\n\n## Library Dependencies\n\n- express\n- cookie-parser\n- csurf\n\n## References\n\n- [OWASP CSRF Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)\n- [CWE-352: Cross-Site Request Forgery (CSRF)](https://cwe.mitre.org/data/definitions/352.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-352",
                    "url": "https://cwe.mitre.org/data/definitions/352.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-352"
                ]
              }
            },
            {
              "id": "3da8c3ba-74c7-3cf4-9ce5-863862d3d245",
              "name": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `Math.random()` function in JavaScript is not suitable for generating cryptographic secrets. The random values it produces are predictable, which makes it possible for an attacker to guess the output and compromise the security of the application. This is a form of Cryptographic Weakness, specifically related to the use of Insufficiently Random Values (CWE-330).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should use a function designed to generate cryptographically secure random values. In Node.js, you can use the `crypto.randomBytes()` function, which generates a buffer of cryptographically secure random bytes.\n\n## Code Fix Recommendation\n\nHere is how you can fix the code:\n\n```javascript\nconst crypto = require('crypto');\n\nlet price = parseInt(crypto.randomBytes(4).readUInt32BE(0, true) % 100);\n```\n\nThis code uses the `crypto.randomBytes()` function to generate a buffer of 4 random bytes, then reads those bytes as a 32-bit unsigned integer. The `% 100` operation ensures the result is between 0 and 99, inclusive.\n\n## Library Dependencies\n\nThe code example requires the built-in `crypto` module in Node.js.\n\n## References\n\n- [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [CWE-330: Use of Insufficiently Random Values](https://cwe.mitre.org/data/definitions/330.html)\n\nPlease note that the links provided are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-330",
                    "url": "https://cwe.mitre.org/data/definitions/330.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-330"
                ]
              }
            },
            {
              "id": "5376f6e2-af4e-3bff-9a5f-9ccb19239bf3",
              "name": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `Math.random()` function in JavaScript is not suitable for generating cryptographic secrets. The random values it produces are predictable, which makes it possible for an attacker to guess the output and compromise the security of the application. This is a form of Cryptographic Weakness, specifically related to the use of Insufficiently Random Values (CWE-330).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should use a function designed to generate cryptographically secure random values. In Node.js, you can use the `crypto.randomBytes()` function, which generates a buffer of cryptographically secure random bytes.\n\n## Code Fix Recommendation\n\nHere is how you can fix the code:\n\n```javascript\nconst crypto = require('crypto');\n\nlet price = parseInt(crypto.randomBytes(4).readUInt32BE(0, true) % 100);\n```\n\nThis code uses the `crypto.randomBytes()` function to generate a buffer of 4 random bytes, then reads those bytes as a 32-bit unsigned integer. The `% 100` operation ensures the result is between 0 and 99, inclusive.\n\n## Library Dependencies\n\nThe code example requires the built-in `crypto` module in Node.js.\n\n## References\n\n- [OWASP Cryptographic Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html)\n- [CWE-330: Use of Insufficiently Random Values](https://cwe.mitre.org/data/definitions/330.html)\n\nPlease note that the links provided are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-330",
                    "url": "https://cwe.mitre.org/data/definitions/330.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-330"
                ]
              }
            },
            {
              "id": "2aa33ec3-ed30-3b51-961e-03b18b59ff4b",
              "name": "\"Dockerfile Vulnerability: Missing '--no-install-recommends' Flag in 'apt-get' Command\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe Dockerfile vulnerability: Missing '--no-install-recommends' flag in 'apt-get' command is a security concern that arises when Docker images are built using the 'apt-get install' command without the '--no-install-recommends' flag. This can lead to the installation of unnecessary packages, increasing the attack surface of the Docker image.\n\n## Security Concern\n\nThe security concern here is that the additional unnecessary packages that get installed may contain vulnerabilities that can be exploited by an attacker. This increases the attack surface of the Docker image. Additionally, these unnecessary packages can also increase the size of the Docker image, leading to longer build and deploy times.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always use the '--no-install-recommends' flag when using the 'apt-get install' command in a Dockerfile. This will ensure that only the necessary packages are installed, reducing the attack surface and the size of the Docker image.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the specific vulnerability sink in your Dockerfile:\n\n```Dockerfile\nRUN apt-get update && apt-get install --no-install-recommends -y netcat\n```\n\n## Library Dependencies\n\nThe code example provided does not require any library dependencies to execute properly.\n\n## OWASP and CWE Links\n\n- [CWE-749: Exposed Dangerous Method or Function](https://cwe.mitre.org/data/definitions/749.html)\n\nPlease note that these links are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-749",
                    "url": "https://cwe.mitre.org/data/definitions/749.html"
                  }
                ],
                "severity": "HIGH",
                "kind": "FAIL",
                "tags": [
                  "CWE-749"
                ]
              }
            },
            {
              "id": "1211fffb-8d42-3097-b15b-3804852e1872",
              "name": "URI Contains Username and Password Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe \"URI Contains Username and Password Vulnerability\" is a security issue where sensitive information such as usernames and passwords are included in the URI. This is a problem because URIs are often logged in various places such as browser history, web server logs, and network infrastructure logs. This can lead to exposure of sensitive information to unauthorized individuals.\n\nIn JavaScript, this vulnerability can occur when using libraries or functions that accept a URI for connecting to a database or other services. For example, the code snippet provided is using a PostgreSQL connection string that includes the username and password.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, sensitive information such as usernames and passwords should not be included in the URI. Instead, they should be stored in a secure manner and provided to the function or library in a way that does not expose them in the URI.\n\nFor example, in a Node.js application, environment variables can be used to store sensitive information. These environment variables can then be accessed in the code without exposing the sensitive information in the URI.\n\n## Source Code Fix Recommendation\n\nHere is a recommended fix for the provided code snippet:\n\n```javascript\nconst { Pool } = require('pg');\n\nconst pool = new Pool({\n  user: process.env.PGUSER,\n  host: '127.0.0.1',\n  database: process.env.PGDATABASE,\n  password: process.env.PGPASSWORD,\n  port: process.env.PGPORT,\n});\n\npool.connect();\n```\n\nIn this code, the username and password are not included in the URI. Instead, they are retrieved from environment variables.\n\n## Library Dependencies\n\nThe code example requires the `pg` library for connecting to a PostgreSQL database.\n\n## OWASP and CWE Resources\n\n- [OWASP - Password in Configuration](https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication)\n- [CWE-259: Use of Hard-coded Password](https://cwe.mitre.org/data/definitions/259.html)\n\nPlease note that the links provided are active and accessible to anonymous users at the time of writing this report."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-259",
                    "url": "https://cwe.mitre.org/data/definitions/259.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-259"
                ]
              }
            },
            {
              "id": "67087029-2640-34fb-9f38-289b0f9dc639",
              "name": "High-Risk Dockerfile Vulnerability: Lack of Non-Root User Specification",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe \"High-Risk Dockerfile Vulnerability: Lack of Non-Root User Specification\" is a security vulnerability in Docker where the Dockerfile does not specify a non-root user for running the container. This means that the container runs with root privileges, which can be a significant security risk. If an attacker manages to break out of the container, they would have root access to the host system, which could lead to serious security breaches.\n\n## Security Concern\n\nRunning a Docker container as root is a security concern because it gives the container full control over the host system. If an attacker manages to exploit a vulnerability in the container, they could potentially gain root access to the host system, which would allow them to execute arbitrary commands, access sensitive data, or even take over the system entirely.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always specify a non-root user in the Dockerfile using the `USER` directive. This ensures that the container runs with the privileges of that user, which limits the potential damage if the container is compromised.\n\n## Source Code Fix Recommendation\n\nHere is a fixed version of the Dockerfile:\n\n```Dockerfile\nFROM postgres:15.1-bullseye\n\n# Create a non-root user\nRUN useradd -ms /bin/bash nonrootuser\n\n# Switch to the non-root user\nUSER nonrootuser\n```\n\nIn this fixed version, a non-root user is created and then used to run the container.\n\n## Library Dependencies\n\nThe code example does not require any library dependencies to execute properly.\n\n## References\n\n- [CWE-250: Execution with Unnecessary Privileges](https://cwe.mitre.org/data/definitions/250.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-250",
                    "url": "https://cwe.mitre.org/data/definitions/250.html"
                  }
                ],
                "severity": "HIGH",
                "kind": "FAIL",
                "tags": [
                  "CWE-250"
                ]
              }
            },
            {
              "id": "09f87833-7816-324f-9eba-159ae7844489",
              "name": "High-Risk Dockerfile Vulnerability: Lack of Non-Root User Specification",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe \"High-Risk Dockerfile Vulnerability: Lack of Non-Root User Specification\" is a security vulnerability in Docker where the Dockerfile does not specify a non-root user for running the container. This means that the Docker container runs with root privileges, which can be a significant security risk. If an attacker manages to break out of the container, they would have root access to the host system, potentially leading to a full system compromise.\n\n## Security Concern\n\nRunning a Docker container as root is a security concern because it gives the container full control over the host system. This means that if an attacker manages to exploit a vulnerability in the container, they could potentially gain full control over the host system. This could lead to data loss, data theft, or a denial of service.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always specify a non-root user in the Dockerfile using the `USER` directive. This ensures that the container runs with limited privileges, reducing the potential impact of a container breakout.\n\n## Source Code Fix Recommendation\n\nHere is a fixed version of the Dockerfile:\n\n```Dockerfile\nFROM node:19.4.0-bullseye-slim\n\n# Create app directory\nWORKDIR /usr/src/app\n\n# Install app dependencies\nCOPY package*.json ./\n\nRUN npm install\n\n# Bundle app source\nCOPY . .\n\n# Create a user named \"appuser\"\nRUN useradd -m appuser\n\n# Switch to \"appuser\"\nUSER appuser\n\nCMD [ \"node\", \"app.js\" ]\n```\n\nIn this fixed version, a new user named \"appuser\" is created and the `USER` directive is used to switch to this user. This ensures that the container runs with the privileges of \"appuser\" instead of root.\n\n## References\n\n- [CWE-250: Execution with Unnecessary Privileges](https://cwe.mitre.org/data/definitions/250.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-250",
                    "url": "https://cwe.mitre.org/data/definitions/250.html"
                  }
                ],
                "severity": "HIGH",
                "kind": "FAIL",
                "tags": [
                  "CWE-250"
                ]
              }
            },
            {
              "id": "ba370b09-7185-322d-8cf7-998c410dacf4",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, crashes, and potential security vulnerabilities. In the provided code, the promise returned by `db.one()` is not handling any potential errors that might occur during the execution of the SQL query.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always include error handling for promises. This can be done by chaining a `.catch()` method to the promise, which will be invoked when the promise is rejected. The `.catch()` method should contain logic to handle the error appropriately, such as logging the error and returning a response to the client indicating that an error occurred.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\ndb.one('CREATE TABLE users(name VARCHAR(100) PRIMARY KEY, password VARCHAR(50));')\n    .then(function () {\n        // Handle successful execution here\n    })\n    .catch(function (error) {\n        // Handle error here\n        console.error(error);\n    });\n```\n\n## Library Dependencies\n\nThe provided code seems to be using a promise-based database library, but it's not clear which one. It could be any library that provides a `db.one()` method that returns a promise, such as `pg-promise`.\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "857685af-565e-3914-be90-24868f24eb92",
              "name": "Detected Hard-Coded Credential Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nDetected Hard-Coded Credential Vulnerability refers to the insecure practice of embedding plaintext credentials directly within the source code. This vulnerability can lead to unauthorized access to systems or data if the source code is exposed or accessible. In JavaScript, this vulnerability can occur when sensitive data like API keys, database credentials, or other secrets are hard-coded in the script.\n\n## Mitigation Advice\n\nAvoid hard-coding sensitive information directly in your source code. Instead, use environment variables, configuration files, or secure vaults to store this information. These methods allow you to separate your credentials from your source code, making it harder for an attacker to gain access to them.\n\n## Source Code Fix Recommendation\n\nInstead of hard-coding the secret directly in your code, you can use environment variables to store this information. Here's how you can do it:\n\n```javascript\nconst secret = process.env.SECRET;\n```\n\nThen, you can set the `SECRET` environment variable in your server environment or in a `.env` file (which should be added to your `.gitignore` file to prevent it from being committed to your repository).\n\n## Library Dependencies\n\nThe code example does not require any specific library dependencies to execute properly.\n\n## OWASP and CWE Resources\n\n- [OWASP: Hardcoded Secrets](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#hardcoded-secrets)\n- [CWE-798: Use of Hard-coded Credentials](https://cwe.mitre.org/data/definitions/798.html)\n\nPlease note that these links are subject to change and may not always be accessible. Always refer to the latest OWASP and CWE guidelines for the most accurate and up-to-date information."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-798",
                    "url": "https://cwe.mitre.org/data/definitions/798.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-798"
                ]
              }
            },
            {
              "id": "acb8f5a9-af8e-3940-a463-8c7d6d4c3700",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, crashes, and potential security vulnerabilities. In the provided code, the promise returned by `db.one` is not handling potential rejections, which could lead to unhandled promise rejections if the `CREATE TABLE` operation fails for any reason.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always ensure that promises have both a `then` clause and a `catch` clause. The `catch` clause should handle any errors that occur during the execution of the promise. This will prevent unhandled promise rejections and ensure that your application behaves predictably even when operations fail.\n\n## Source Code Fix Recommendation\n\nHere is a fixed version of the provided code:\n\n```javascript\ndb.one('CREATE TABLE products(id INTEGER PRIMARY KEY, name VARCHAR(100) not null, description TEXT not null, price INTEGER, image VARCHAR(500))')\n    .then(function () {\n        // Handle successful table creation here\n    })\n    .catch(function (error) {\n        // Handle errors here\n        console.error('Error creating table:', error);\n    });\n```\n\nIn this version of the code, any errors that occur during the `CREATE TABLE` operation will be caught and logged to the console. You can replace the `console.error` call with your own error handling logic as appropriate for your application.\n\n## Library Dependencies\n\nThe provided code appears to use the `pg-promise` library for PostgreSQL database interaction. Ensure that this library is installed and properly configured in your project.\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "178c673e-0418-30d2-af05-2976663a00ae",
              "name": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nCross-Site Scripting (XSS) vulnerabilities occur when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. XSS allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nThe provided code snippet is vulnerable to XSS because it directly uses user-controlled data (`username` and `password`) in an SQL query string without any sanitization or escaping. This could allow an attacker to inject malicious SQL commands.\n\n## Mitigation Advice\n\nTo mitigate XSS vulnerabilities, you should:\n\n- Use a safe API which avoids the use of the interpreter entirely or provides a parameterized interface.\n- For any data that is included in dynamic content, ensure it is properly escaped for the interpreter context it will be included in.\n- Apply context-sensitive encoding when modifying the browser document on the client side.\n- Use an appropriate web application firewall.\n\n## Source Code Fix Recommendation\n\nThe code snippet provided is actually more vulnerable to SQL Injection than XSS. To fix this, you should use parameterized queries or prepared statements. Here is an example using Node.js and MySQL:\n\n```javascript\nvar mysql = require('mysql');\nvar connection = mysql.createConnection({\n  host     : 'localhost',\n  user     : 'me',\n  password : 'secret',\n  database : 'my_db'\n});\n\nconnection.connect();\n\nvar username = 'some user input';\nvar password = 'some user input';\n\nvar query = 'SELECT * FROM users WHERE name = ? AND password = ?';\nconnection.query(query, [username, password], function (error, results, fields) {\n  if (error) throw error;\n  // ...\n});\n```\n\n## Library Dependencies\n\nThe code example requires the `mysql` library to execute properly.\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)\n- [CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')](https://cwe.mitre.org/data/definitions/89.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  },
                  {
                    "id": "CWE-89",
                    "url": "https://cwe.mitre.org/data/definitions/89.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79",
                  "CWE-89"
                ]
              }
            },
            {
              "id": "06bbf79d-b014-3d8f-9474-ab242201bf88",
              "name": "Unset 'secure' in default session middleware settings vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe `secure` flag in the session middleware settings is set to `false`. This means that the cookie will be transmitted over insecure connections. This is a vulnerability because it allows attackers to intercept the cookie and potentially gain unauthorized access to the application.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should set the `secure` flag to `true`. This will ensure that the cookie is only transmitted over secure (HTTPS) connections. \n\n## Source Code Fix Recommendation\n\nHere is how you can fix the vulnerability in your code:\n\n```javascript\napp.use(session({\n  secret: 'asddfilhpaf78h78032h780g780fg780asg780dsbovncubuyvqy',\n  cookie: {\n    secure: true,\n    maxAge: 99999999999\n  }\n}));\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js\n- Express-session\n\n## References\n\n- [OWASP Secure Flags](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#secure-attribute)\n- [CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute](https://cwe.mitre.org/data/definitions/614.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-614",
                    "url": "https://cwe.mitre.org/data/definitions/614.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-614"
                ]
              }
            },
            {
              "id": "ce3b97d0-f97d-367b-a7ce-27c024f46a63",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. EJS (Embedded JavaScript) is a simple templating language that lets you generate HTML markup with plain JavaScript. However, if user-supplied data is not properly escaped, it can lead to Cross-Site Scripting (XSS) attacks. In XSS attacks, an attacker can inject malicious scripts into web pages viewed by other users, which can lead to a variety of attacks such as stealing user data, spreading malware, etc.\n\nIn the provided code snippet, the product ID is being output directly into the HTML without being escaped. This means that if the product ID contains any malicious scripts, they will be executed when the page is loaded.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape user-supplied data before outputting it into your HTML. This can be done using the `escape` function provided by EJS. This function will replace any potentially dangerous characters with their HTML-encoded equivalents, preventing any scripts from being executed.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code snippet:\n\n```javascript\n<td><%= ejs.escape(products[i].product_id) %></td>\n```\n\nIn this fixed code, the `escape` function is used to safely output the product ID.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## OWASP and CWE Links\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "59392c6a-966e-3b61-85a9-40f991b54abe",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, including crashes and potential security vulnerabilities. In the provided code, the promise returned by `db.one()` is not being handled properly in case of a rejection.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always handle promise rejections. This can be done by adding a `.catch()` block to your promises, which will be executed in case the promise is rejected. This allows you to handle the error gracefully and prevent unexpected application behavior.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\ndb.one('INSERT INTO users(name, password) values($1, $2)', [u.username, u.password])\n    .then(function () {\n        // success;\n    })\n    .catch(function (error) {\n        // handle error\n        console.error(error);\n    });\n```\n\nIn this updated code, a `.catch()` block has been added to handle any errors that may occur when the promise is rejected.\n\n## Library Dependencies\n\nThe provided code seems to be using the `pg-promise` library for PostgreSQL database interaction. So, you need to have `pg-promise` installed in your project.\n\n## References\n\n- [OWASP Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "4277e1ab-3400-3e82-a03c-0bddbe910173",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, crashes, and potential security vulnerabilities. In the provided code, the promise returned by `db.one()` is not being properly handled in case of a rejection.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always handle promise rejections. This can be done by adding a `.catch()` block to your promises, or by using `try/catch` with `async/await`. \n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\ndb.one('INSERT INTO products(id, name, description, price, image) values($1, $2, $3, $4, $5)', [i, p.name, p.description, p.price, p.image])\n    .then(function () {\n        // success;\n    })\n    .catch(function (error) {\n        // handle error\n        console.error(error);\n    });\n```\n\nIn this updated code, if the promise returned by `db.one()` is rejected, the error will be caught and logged to the console.\n\n## Library Dependencies\n\nThe provided code appears to be using the `pg-promise` library for PostgreSQL database interaction.\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "8310b3ee-01cc-37f9-89f8-3b6f896f30d6",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when untrusted data is included in an EJS template without proper escaping. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, manipulate web content, or perform actions on behalf of the user without their consent.\n\nIn the provided code snippet, the vulnerability arises from the use of `<%-` instead of `<%=`, which results in the unescaped output of `products[i].mail`. This means that if `products[i].mail` contains any malicious scripts, they will be executed when the page is rendered.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before including it in your templates. This can be done by using `<%=` instead of `<%-` in EJS templates. The `<%=` syntax automatically escapes any HTML special characters, preventing them from being interpreted as code.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code snippet:\n\n```javascript\n<td><%= products[i].mail %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating engine used to generate HTML markup with plain JavaScript.\n\n## References\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "948a5476-80ea-395c-a62c-e1c1b5a7a750",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application uses untrusted data in the EJS template without proper validation or escaping, allowing an attacker to inject malicious script into web pages viewed by other users. This is a type of Cross-Site Scripting (XSS) vulnerability.\n\nIn the provided code snippet, the application is using the EJS template engine to render data into HTML. The `<%- %>` syntax in EJS is used to output the unescaped value into the template. If `products[i].product_name` contains any malicious script, it will be executed in the browser of the user viewing the page.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data is placed into. In EJS, use `<%= %>` syntax to output escaped values.\n\n## Source Code Fix Recommendation\n\nReplace `<%- products[i].product_name %>` with `<%= products[i].product_name %>`. The updated code should look like this:\n\n```javascript\n<td><%= products[i].product_name %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating engine for generating HTML markup with plain JavaScript.\n\n## Resources\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n\n## Common Weakness Enumeration (CWE)\n\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "e48f1e07-034c-373e-933a-23522af18936",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when untrusted data is inserted into an EJS template without proper sanitization or escaping. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. The injected scripts can be used to steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the web application.\n\nIn the provided code snippet, the vulnerability arises from the use of `<%- products[i].phone %>` which does not escape the output. If `products[i].phone` contains malicious scripts, they will be executed in the user's browser.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape untrusted data before inserting it into the HTML document. In EJS, you can use `<%= ... %>` syntax to escape output. This will ensure that any HTML special characters in the data are replaced with their corresponding HTML entities, preventing them from being interpreted as code by the browser.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code snippet:\n\n```javascript\n<td><%= products[i].phone %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating engine used to generate HTML markup with plain JavaScript.\n\n## References\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "9e411e04-d8ca-3bf8-ac54-e7db7be5ee03",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, including crashes, and can potentially expose sensitive information in error messages.\n\nIn the provided code, a promise is created when a query is sent to the database to create a new table. If this query fails for any reason (for example, if the table already exists), the promise will be rejected. However, there is no `.catch()` block to handle this rejection, leading to an Unhandled Promise Rejection.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always include error handling when working with promises in JavaScript. This can be done by chaining a `.catch()` block onto the end of your promise. The `.catch()` block will be executed if the promise is rejected, allowing you to handle the error appropriately.\n\n## Source Code Fix Recommendation\n\nHere is how you could modify the provided code to handle promise rejections:\n\n```javascript\ndb.one('CREATE TABLE purchases(id SERIAL PRIMARY KEY, product_id INTEGER not null, product_name VARCHAR(100) not null, user_name VARCHAR(100), mail VARCHAR(100) not null, address VARCHAR(100) not null, phone VARCHAR(40) not null, ship_date VARCHAR(100) not null, price INTEGER not null)')\n    .then(function () {\n        // Handle successful query here\n    })\n    .catch(function (error) {\n        // Handle error here\n        console.error('Error creating table:', error);\n    });\n```\n\n## Library Dependencies\n\nThe provided code appears to use the `pg-promise` library for interacting with a PostgreSQL database. Therefore, you would need to have `pg-promise` installed in your project.\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "805b4f7c-6101-3977-a41a-a2dec383ea53",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the vulnerability arises from the use of `<%- %>` syntax in EJS templates, which does not escape the output:\n\n```javascript\n<td><%- products[i].ship_date %></td>\n```\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always use `<%= %>` syntax instead of `<%- %>` in EJS templates to ensure that the output is properly escaped. This will prevent any potentially harmful code from being executed.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the code:\n\n```javascript\n<td><%= products[i].ship_date %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## References\n\n- [OWASP Cross Site Scripting Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "56725a66-eb4c-302e-8dac-05fba34b55f3",
              "name": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nCross-Site Scripting (XSS) vulnerabilities occur when data enters a program from an untrusted source and is used to generate dynamic HTML content. An attacker can inject malicious scripts into the HTML content, which will be executed by the victim's browser. In this case, the vulnerability arises from user-controlled data in an HTML string.\n\nThe provided code snippet is not directly related to XSS, but rather to SQL Injection. However, if the `product_id` is used elsewhere in the code to generate HTML content, it could potentially lead to an XSS vulnerability.\n\n## Mitigation Advice\n\nTo mitigate this type of vulnerability, you should always validate, sanitize, and escape user input. Never trust data coming from users. \n\n- **Validate**: Check if the user input meets certain criteria (e.g., length, type, format).\n- **Sanitize**: Clean the user input to remove any unwanted or malicious data.\n- **Escape**: Ensure that the user input is safe to display in the browser.\n\n## Source Code Fix Recommendation\n\nThe provided code snippet is vulnerable to SQL Injection, not XSS. However, to prevent SQL Injection, you should use parameterized queries or prepared statements. Here is how you can fix the code:\n\n```javascript\nvar sql = \"SELECT * FROM products WHERE id = ?;\";\nconnection.query(sql, [product_id], function (error, results, fields) {\n  if (error) throw error;\n  // ...\n});\n```\n\nThis code assumes that you are using the `mysql` library in Node.js. The `?` is a placeholder for the `product_id`, which is provided as an array in the second argument of the `query` function. This ensures that the `product_id` is properly escaped, preventing SQL Injection.\n\n## Library Dependencies\n\nThe provided code snippet does not specify any library dependencies. However, the fixed code snippet requires the `mysql` library in Node.js.\n\n## OWASP Resources\n\n- [Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n\n## Common Weakness Enumeration (CWE)\n\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)\n\nPlease note that the links provided are valid and active at the time of writing."
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "aed8664a-9651-3c61-95e7-f3f542acfcab",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application using the EJS (Embedded JavaScript) templating library in JavaScript does not properly escape external data before including it in a web page. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the user's browser or system.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before including it in a web page. This can be done using the EJS escape function, which replaces special characters with their HTML-encoded equivalents. Also, avoid using the `<%-` syntax in EJS templates, as this does not escape the output.\n\n## Source Code Fix Recommendation\n\nReplace `<%-body%>` with `<%=body%>`. The `<%=` syntax automatically escapes the output in EJS.\n\n```javascript\n<%=body%>\n```\n\n## Library Dependencies\n\nThe code example requires the `ejs` library to execute properly.\n\n```bash\nnpm install ejs\n```\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "3b0b252d-5ac4-3ff3-a541-0cf12d17c691",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. In the provided code snippet, the vulnerability arises from the use of `<%- products[i].address %>` which does not escape the output.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before using it in your templates. This can be done using the `<%= %>` syntax in EJS, which automatically escapes the output.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code snippet:\n\n```javascript\n<td><%= products[i].address %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "688d7e11-f151-3845-b990-6543df5eb742",
              "name": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nCross-Site Scripting (XSS) vulnerabilities occur when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. XSS allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nThe provided JavaScript code snippet is vulnerable to XSS because it concatenates a user-supplied string (`query`) directly into an SQL query. This not only opens up potential for SQL Injection attacks, but also for XSS attacks if the result of this query is then used to dynamically generate HTML without proper escaping.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should:\n\n1. Use parameterized queries or prepared statements to prevent SQL Injection. This ensures that user input is always treated as literal data and not part of the SQL command.\n\n2. Always encode user-supplied data before including it in HTML output. This ensures that any HTML special characters in the user input are treated as literal text and not interpreted as part of the HTML markup.\n\n3. Use Content Security Policy (CSP) to reduce the severity of any XSS vulnerabilities by declaring what dynamic resources are allowed to load.\n\n## Source Code Fix\n\nHere is a recommended fix for the provided code snippet:\n\n```javascript\nvar pg = require('pg');\nvar conString = \"postgres://username:password@localhost/database\";\n\nvar client = new pg.Client(conString);\nclient.connect();\n\nvar query = client.query(\"SELECT * FROM products WHERE name ILIKE $1 OR description ILIKE $1\", ['%' + userInput + '%']);\n```\n\n## Library Dependencies\n\nThe provided code example requires the `pg` library for connecting to a PostgreSQL database.\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "41019249-7fa3-3799-9cc8-937413eefa84",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the user's browser.\n\nIn the provided code snippet, the vulnerability arises from the use of `<%- products[i].price %>?` which does not escape the output. If `products[i].price` contains a malicious script, it will be executed when the page is rendered.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before using it in your templates. This can be done using the `<%= %>` syntax in EJS, which automatically escapes the output.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code snippet:\n\n```javascript\n<td><%= products[i].price %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies to execute properly:\n\n- EJS\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "ee07ba45-c1e9-37f0-b3f4-cf26cc0e40e0",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application using the EJS (Embedded JavaScript) templating library in JavaScript does not properly escape external data before including it in a web page. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the user's browser or system.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before including it in a web page. This can be done using the EJS escape function, which replaces special characters with their HTML-encoded equivalents. Also, avoid using the `<%-` syntax in EJS templates, as this does not escape the output.\n\n## Source Code Fix Recommendation\n\nReplace `<%-body%>` with `<%=body%>`. The `<%=` syntax automatically escapes the output in EJS.\n\n```javascript\n<%=body%>\n```\n\n## Library Dependencies\n\nThe code example requires the `ejs` library to execute properly.\n\n```bash\nnpm install ejs\n```\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "9c4cd823-9136-3b26-82e1-9e7e4b04aa4f",
              "name": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nCross-Site Scripting (XSS) vulnerabilities occur when data enters a web application through an untrusted source, in this case, user-controlled data in an HTML string, and is used in the generation of dynamic content without being properly validated or escaped. This allows an attacker to inject malicious scripts and have them executed by the victim's browser. \n\nIn the provided JavaScript code, the application is vulnerable to XSS because it directly uses user-controlled data (`cart.*`) in a SQL query string without proper sanitization or parameterization. This could allow an attacker to inject malicious SQL commands.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should:\n\n1. **Escape User Input**: Always escape user-controlled data before using it in HTML or SQL queries. This ensures that any special characters are treated as literal characters and not as part of the HTML or SQL syntax.\n\n2. **Use Prepared Statements**: Instead of dynamically building SQL queries with user input, use prepared statements, parameterized queries, or stored procedures. These methods ensure that user input is always treated as literal data and not executable code.\n\n3. **Apply Principle of Least Privilege**: Ensure that the database user used by the application has only the privileges necessary to perform its tasks. This can limit the potential damage of a successful SQL injection attack.\n\n## Source Code Fix Recommendation\n\nThe code should be modified to use parameterized queries instead of string concatenation. Here's an example using Node.js and the `pg` library:\n\n```javascript\nconst { Pool } = require('pg');\nconst pool = new Pool();\n\nlet queryText = 'INSERT INTO purchases(mail, product_name, user_name, product_id, address, phone, ship_date, price) VALUES($1, $2, $3, $4, $5, $6, $7, $8)';\nlet values = [cart.mail, cart.product_name, cart.username, cart.product_id, cart.address, cart.phone, cart.ship_date, cart.price];\n\npool.query(queryText, values, (err, res) => {\n    if (err) {\n        console.log(err.stack);\n    } else {\n        console.log(res.rows[0]);\n    }\n});\n```\n\n## Library Dependencies\n\nThe code example requires the `pg` library for PostgreSQL database interaction in Node.js.\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)\n- [CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')](https://cwe.mitre.org/data/definitions/89.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  },
                  {
                    "id": "CWE-89",
                    "url": "https://cwe.mitre.org/data/definitions/89.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79",
                  "CWE-89"
                ]
              }
            },
            {
              "id": "a578538d-e4b5-3d53-b8a7-c838e34aa714",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS Template XSS Vulnerability Detected Due to Unescaped External Data is a security vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape untrusted HTTP request data based on the context in the HTML output (HTML body, HTML attribute, JavaScript, CSS, or URL) will be consumed. Use the OWASP Cheat Sheet 'XSS Prevention' as a guide. \n\n## Source Code Fix Recommendation\n\nIn the provided code snippet, the `returnurl` is not being escaped which can lead to XSS attacks. To fix this, you should use `<%= returnurl %>` instead of `<%- returnurl %>`. The `<%=` syntax automatically escapes output.\n\n```html\n<input type=\"hidden\" id=\"returnurl\" class=\"form-control\" name=\"returnurl\" value=\"<%=returnurl%>\">\n```\n\n## Library Dependencies\n\nThe code example provided requires the following library dependencies:\n\n- EJS (Embedded JavaScript templates)\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "b8f3e78a-fec3-34a1-8a62-032be16facc2",
              "name": "'Get' requests managed by '/login' HTTP route in Express.",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe code snippet above is an Express.js route handler for GET requests to the '/login' path. It is vulnerable to Unvalidated Redirects and Forwards. The vulnerability arises from the fact that the 'returnurl' parameter from the request URL is directly used to render the login page without any validation. An attacker can manipulate the 'returnurl' parameter to redirect the user to a malicious site after login, leading to potential phishing attacks.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to validate the 'returnurl' parameter before using it. This can be done by maintaining a whitelist of allowed URLs for redirection and checking if the 'returnurl' is in this list. If it is not, the application should not proceed with the redirection.\n\n## Source Code Fix\n\nHere is a fixed version of the code:\n\n```javascript\nvar allowedUrls = ['http://example.com', 'http://example2.com']; // Add your allowed URLs here\n\nrouter.get('/login', function(req, res, next) {\n    var url_params = url.parse(req.url, true).query;\n    var returnurl = allowedUrls.includes(url_params.returnurl) ? url_params.returnurl : '/default';\n\n    res.render('login', {returnurl: returnurl, auth_error: url_params.error});\n});\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- express\n- url\n\n## References\n\n- [OWASP Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)\n- [CWE-601: URL Redirection to Untrusted Site ('Open Redirect')](https://cwe.mitre.org/data/definitions/601.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-601",
                    "url": "https://cwe.mitre.org/data/definitions/601.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-601"
                ]
              }
            },
            {
              "id": "a45d3813-a28c-36a0-b088-4cab93d02328",
              "name": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nA potential Cross-Site Scripting (XSS) vulnerability from user-controlled data in HTML string is a security flaw that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. XSS allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided JavaScript code, the variable `q` is constructed by concatenating a static string with a variable `username`. If the `username` is user-controlled and not properly sanitized, it can lead to an XSS vulnerability.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should:\n\n1. **Escape User Input**: Always escape user-controlled data before rendering it in HTML. This can be done using functions provided by many web development frameworks or libraries.\n\n2. **Use Prepared Statements**: For SQL queries, use prepared statements or parameterized queries. These methods automatically escape special characters and thus prevent SQL injection attacks.\n\n3. **Content Security Policy (CSP)**: Implementing CSP makes it possible for server administrators to reduce or eliminate the vectors by which XSS can occur by specifying the domains that the browser should consider to be valid sources of executable scripts.\n\n## Source Code Fix Recommendation\n\nThe provided code does not have any library dependencies. However, it is vulnerable to SQL Injection attacks. Here is a fix using parameterized queries (assuming a MySQL database and the `mysql` library):\n\n```javascript\nvar mysql = require('mysql');\nvar connection = mysql.createConnection({\n  host     : 'localhost',\n  user     : 'me',\n  password : 'secret',\n  database : 'my_db'\n});\n\nvar username = 'some user';\nvar sql = \"SELECT * FROM purchases WHERE user_name = ?\";\nvar inserts = [username];\nsql = mysql.format(sql, inserts);\n\nconnection.query(sql, function (error, results, fields) {\n  if (error) throw error;\n  // ...\n});\n```\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "901d0f96-814f-34dc-8ab0-5b556a5e7752",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the `auth_error` variable is being rendered without being escaped. This means that if `auth_error` contains any malicious scripts, they will be executed when the page is rendered.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always escape untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. In this case, since `auth_error` is being rendered in an HTML context, it should be HTML escaped.\n\n## Source Code Fix Recommendation\n\nYou can fix this vulnerability by using the `<%= %>` syntax instead of `<%- %>`. The `<%= %>` syntax HTML escapes the output:\n\n```javascript\n<span class=\"label label-danger\"><%=auth_error%></span>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS (Embedded JavaScript templates)\n\n## References\n\n- [OWASP Cross Site Scripting Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "cffc779b-f372-3e1c-a2fb-3103747f3b04",
              "name": "Post requests will be managed by '/login/auth' HTTP route in Express.",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe provided JavaScript code is an Express.js route handler for POST requests to '/login/auth'. It is vulnerable to several security issues:\n\n1. **Logging Sensitive Information**: The code logs the username of every login attempt. If an attacker gains access to these logs, they can gather valid usernames for further attacks.\n\n2. **Lack of Input Validation**: The code does not validate the input received in the request body. This can lead to various attacks such as SQL Injection, Cross-Site Scripting (XSS), etc.\n\n3. **Insecure Direct Object References (IDOR)**: The code uses the 'returnurl' parameter from the request body to redirect the user. An attacker can manipulate this parameter to redirect users to malicious websites.\n\n4. **Session Management**: The code sets 'req.session.logged' and 'req.session.user_name' directly after successful authentication. If the session management is not properly implemented, it can lead to Session Hijacking or Session Sidejacking attacks.\n\n## Mitigation Advice\n\n1. **Avoid Logging Sensitive Information**: Do not log sensitive information like usernames, passwords, etc. If logging is necessary, make sure to anonymize the data.\n\n2. **Input Validation**: Always validate and sanitize user inputs. Use a library like [validator.js](https://www.npmjs.com/package/validator) for input validation.\n\n3. **Secure Redirects**: Validate the 'returnurl' parameter to ensure it's a safe URL within your application. Do not allow arbitrary redirects.\n\n4. **Secure Session Management**: Use secure session management libraries like [express-session](https://www.npmjs.com/package/express-session). Implement measures like session expiration, regeneration, etc.\n\n## Source Code Fix\n\n```javascript\nvar validator = require('validator');\nvar expressSession = require('express-session');\n\nrouter.post('/login/auth', function(req, res) {\n    var user = validator.escape(req.body.username);\n    var password = validator.escape(req.body.password);\n    var returnurl = validator.isURL(req.body.returnurl, {require_tld: false}) ? req.body.returnurl : \"/\";\n\n    auth(user, password)\n        .then(function (data) {\n            req.session.regenerate(function(err) {\n                req.session.logged = true;\n                req.session.user_name = user;\n                res.redirect(returnurl);\n            });\n        })\n        .catch(function (err) {\n            res.redirect(\"/login?returnurl=\" + returnurl + \"&error=\" + err.message);\n        });\n});\n```\n\n## Library Dependencies\n\n- express\n- validator\n- express-session\n\n## References\n\n- [OWASP Top 10 - 2017](https://owasp.org/www-project-top-ten/2017/)\n- [CWE-209: Information Exposure Through an Error Message](https://cwe.mitre.org/data/definitions/209.html)\n- [CWE-601: URL Redirection to Untrusted Site ('Open Redirect')](https://cwe.mitre.org/data/definitions/601.html)\n- [CWE-384: Session Fixation](https://cwe.mitre.org/data/definitions/384.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-209",
                    "url": "https://cwe.mitre.org/data/definitions/209.html"
                  },
                  {
                    "id": "CWE-601",
                    "url": "https://cwe.mitre.org/data/definitions/601.html"
                  },
                  {
                    "id": "CWE-384",
                    "url": "https://cwe.mitre.org/data/definitions/384.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-209",
                  "CWE-601",
                  "CWE-384"
                ]
              }
            },
            {
              "id": "b92355d1-8fbf-3e21-a1e2-8b6f2ffe63fe",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. In the provided code snippet, the vulnerability lies in the use of `<%- product.image %>`, which does not escape the `product.image` data.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before using it in your templates. This can prevent potential XSS attacks. In EJS, you can use `<%= %>` instead of `<%- %>` to escape the data.\n\n## Source Code Fix Recommendation\n\nHere is the fixed code:\n\n```ejs\n<img class=\"img-responsive\" src=\"<%= product.image %>\" alt=\"\">\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js: A web application framework for Node.js.\n- EJS: A simple templating language that lets you generate HTML markup with plain JavaScript.\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "f040fdd4-1f86-37e7-a1a5-67da2fa40546",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the user's browser.\n\nIn the provided code snippet, the vulnerability arises from the use of `<%- product.price %>` which does not escape the output. If `product.price` contains a malicious script, it will be executed in the user's browser.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before using it in your templates. This can be done using the `<%= %>` syntax in EJS, which automatically escapes the output.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the code:\n\n```html\n<h4 class=\"pull-right\"><%= product.price %> ?</h4>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js\n- EJS\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "f796643e-3578-3cbe-957a-4bfd94543d18",
              "name": "\"Open Redirect Vulnerability in URL Building Application\"",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nOpen Redirect Vulnerability in URL Building Application is a security flaw in a web application that occurs when an application allows redirection to an external site or resource without proper validation of the target URL. This vulnerability can be exploited by attackers to trick users into visiting malicious sites, leading to phishing attacks, session theft, or forcing users to perform unwanted actions.\n\nIn JavaScript, this vulnerability can occur when using the `res.redirect()` function, as in the provided sink:\n\n```javascript\nres.redirect(returnurl);\n```\n\nIn this case, if the `returnurl` is not properly validated, an attacker could provide a malicious URL, causing the application to redirect users to an attacker-controlled site.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it's crucial to validate and sanitize all user inputs, especially those used in URL redirection. Avoid using user input directly in `res.redirect()` function. If it's necessary to use user input for redirection, ensure that the input is validated against a whitelist of allowed URLs.\n\n## Source Code Fix Recommendation\n\nHere's a simple example of how you could validate the `returnurl` against a whitelist:\n\n```javascript\nvar allowedUrls = ['http://www.example1.com', 'http://www.example2.com'];\n\nif (allowedUrls.indexOf(returnurl) > -1) {\n    res.redirect(returnurl);\n} else {\n    // Redirect to a default page or show an error\n    res.redirect('/defaultpage');\n}\n```\n\n## Library Dependencies\n\nThe provided code example seems to be using Express.js, a web application framework for Node.js. Therefore, the `express` package is required.\n\n## References\n\n- [OWASP Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)\n- [CWE-601: URL Redirection to Untrusted Site ('Open Redirect')](https://cwe.mitre.org/data/definitions/601.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-601",
                    "url": "https://cwe.mitre.org/data/definitions/601.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-601"
                ]
              }
            },
            {
              "id": "5b0bc7e4-496e-3053-ba40-a2a215b22f12",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"Unhandled Promise Rejection Vulnerability\" in JavaScript occurs when a Promise is rejected but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, crashes, and potential security vulnerabilities. In the provided code, the `auth(user, password)` function returns a Promise, but there is no `.catch()` block to handle any errors that might occur during the authentication process.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always include error handling for Promises. This can be done by chaining a `.catch()` block after your `.then()` block. The `.catch()` block will catch any errors that occur in the Promise and allow you to handle them appropriately.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\nauth(user, password)\n    .then(function (data) {\n        req.session.logged = true;\n        req.session.user_name = user;\n\n        if (returnurl == undefined || returnurl == \"\"){\n            returnurl = \"/\";\n        }\n\n        res.redirect(returnurl);\n    })\n    .catch(function (error) {\n        // Handle the error here\n        console.error('Authentication error:', error);\n    });\n```\n\nIn the above code, if the `auth(user, password)` Promise is rejected, the error will be caught and logged to the console. You should replace the `console.error()` call with appropriate error handling code for your application.\n\n## Library Dependencies\n\nThe provided code appears to be using Express.js for handling HTTP requests and responses, and some form of session middleware (such as express-session) for handling session data. Therefore, the following libraries are required:\n\n- express\n- express-session\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "b97f985f-8494-35f3-bdb2-e522205caa11",
              "name": "'Get' requests managed by '/logout' HTTP route in Express",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe code snippet provided is an Express.js route handler for the '/logout' path. It is designed to log out a user by setting the `logged` property of the session object to `false` and the `user` property to `null`. However, this code does not have any vulnerability in itself. \n\nThe potential vulnerability could arise if the session management is not properly implemented in the application. For instance, if the session cookies are not properly secured, it could lead to session hijacking attacks. Also, if the application does not properly invalidate the session on the server side after logout, it could lead to session reuse attacks.\n\n## Mitigation\n\nTo mitigate potential session management vulnerabilities, you should:\n\n- Use secure, HttpOnly, and SameSite attributes for session cookies to prevent them from being accessed by client-side scripts or being sent along with cross-site requests.\n- Invalidate the session on the server side after logout. Simply setting the session properties to their initial state may not be enough. You should use the `req.session.destroy()` method provided by the Express.js session middleware to completely destroy the session.\n- Implement proper error handling. If an error occurs during the logout process, the application should handle it properly and not leave the session in an undefined state.\n\n## Code Fix\n\nHere is the recommended fix for the code:\n\n```javascript\nrouter.get('/logout', function(req, res, next) {\n    req.session.destroy(function(err) {\n        if(err) {\n            return next(err);\n        }\n        res.redirect(\"/login\");\n    });\n});\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- express: A web application framework for Node.js.\n- express-session: A middleware for handling session in Express.js applications.\n\n## References\n\n- [OWASP Session Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)\n- [CWE-613: Insufficient Session Expiration](https://cwe.mitre.org/data/definitions/613.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-613",
                    "url": "https://cwe.mitre.org/data/definitions/613.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-613"
                ]
              }
            },
            {
              "id": "aab1f37c-9ec7-3509-a7b0-5d16d67c9eab",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the user's browser.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before using it in an EJS template. This can be done using the `<%- %>` syntax in EJS, which escapes HTML characters. Never use the `<%= %>` syntax with untrusted data, as this does not escape HTML characters.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code:\n\n```ejs\n<h4><a href=\"#\"><%- product.name %></a></h4>\n```\n\nIn this code, the `<%- %>` syntax is used to escape HTML characters in `product.name`.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## OWASP Resources\n\n- [Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP Cheat Sheet Series - XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n\n## Common Weakness Enumeration (CWE)\n\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "7ce90906-10b6-3506-9d7d-1ce0ed41d02d",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS (Embedded JavaScript) Template XSS (Cross-Site Scripting) Vulnerability is a security flaw that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the value of the product price is being rendered directly into the HTML without any form of escaping or sanitization. This means that if the product price contains any malicious scripts, they will be executed when the page is rendered in the browser.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always escape external data before including it in your HTML. This can be done using the EJS escape function `<%= %>`. This function will convert any special characters into their HTML encoded equivalents, preventing them from being interpreted as code by the browser.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the code:\n\n```html\n<input type=\"text\" class=\"form-control\" name=\"price\" id=\"price\" value=\"<%= product.price %>\" readonly>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "f3c56ed7-8c0a-3776-afc8-166b2bc520ff",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nEJS (Embedded JavaScript) templates are a popular templating engine in JavaScript. The vulnerability arises when the `<%- %>` syntax is used in EJS templates, which does not escape HTML characters. This means that if the data inserted into the template contains any HTML tags, they will be rendered as HTML by the browser, leading to potential Cross-Site Scripting (XSS) attacks.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always use the `<%= %>` syntax in EJS templates when inserting user-supplied data. This syntax automatically escapes HTML characters, preventing any inserted HTML tags from being rendered by the browser.\n\n## Source Code Fix Recommendation\n\nChange the vulnerable line of code from:\n\n```javascript\n<p><%-product.description%> </p>\n```\n\nto:\n\n```javascript\n<p><%=product.description%> </p>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating library.\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "d4714d13-9142-329f-b7e1-989015bad18f",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS (Embedded JavaScript) Template XSS (Cross-Site Scripting) Vulnerability is a security flaw that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the vulnerability arises from the unescaped external data (`product.id` and `product.image`) that is being embedded into the HTML. If an attacker can control the `product.id` or `product.image`, they can inject malicious scripts that will be executed when the page is rendered.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always escape untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. In EJS, you can use `<%- %>` to output the unescaped value into the template.\n\n## Source Code Fix Recommendation\n\nThe provided code snippet is already using `<%- %>` to output unescaped values, which is the correct way to prevent XSS in EJS. If the `product.id` and `product.image` are user-controlled and you want to prevent potential script injection, you should validate and sanitize these values before rendering them in the template.\n\n```html\n<a href=\"/products/detail?id=<%- encodeURIComponent(product.id) %>\"><img src=\"/images/<%- encodeURIComponent(product.image) %>\" alt=\"\"></a>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## OWASP Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n\n## Common Weakness Enumeration (CWE)\n\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "6b00cf90-e1f9-3a5e-850c-e22e81e3d130",
              "name": "Open Redirect Vulnerability due to Untrusted User Input in redirect()",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nOpen Redirect Vulnerability due to Untrusted User Input in `redirect()` is a common security vulnerability in JavaScript, particularly in Express.js applications. This vulnerability occurs when an application incorporates user input into a URL redirect without validating the input. This allows an attacker to redirect users to malicious websites, leading to phishing attacks, session theft, and other malicious activities.\n\nIn the provided code snippet, the application is redirecting the user to a URL constructed by appending the user's input (`req.url`) to a base string (\"/login?returnurl=\"). This is a security risk as it allows an attacker to manipulate the `req.url` to redirect users to a malicious site.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to validate and sanitize all user inputs. Avoid using user input directly in functions that determine the flow of the application, such as `redirect()`. If it's necessary to use user input in such functions, ensure that the input is safe and intended. \n\n## Source Code Fix Recommendation\n\nA simple fix would be to validate the `req.url` before using it in the `redirect()` function. Here's an example of how you can do this:\n\n```javascript\nvar url = require('url');\nvar returnUrl = url.parse(req.url).pathname;\nif (returnUrl.startsWith('/')) {\n    res.redirect(\"/login?returnurl=\" + returnUrl);\n} else {\n    res.redirect(\"/login\");\n}\n```\n\nIn this code, we're using Node.js's `url` module to parse the `req.url` and extract the pathname. If the pathname starts with a '/', indicating it's a relative URL, we use it in the `redirect()`. Otherwise, we redirect to the login page without the `returnurl` parameter.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js\n- Node.js's built-in `url` module\n\n## References\n\n- [OWASP Unvalidated Redirects and Forwards Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html)\n- [CWE-601: URL Redirection to Untrusted Site ('Open Redirect')](https://cwe.mitre.org/data/definitions/601.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-601",
                    "url": "https://cwe.mitre.org/data/definitions/601.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-601"
                ]
              }
            },
            {
              "id": "5aa0b11d-6fa7-305c-91cd-35cb88cce3b8",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS (Embedded JavaScript) Template XSS (Cross-Site Scripting) Vulnerability is a security flaw that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute malicious scripts in the browser of the end user by injecting malicious code into the page.\n\nIn the provided code snippet, the value of the hidden input field is being populated with the product id without escaping the data. If the product id is somehow manipulated to include malicious script, it can lead to an XSS attack.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape external data before including it into the HTML content. This can be done using the EJS escape function. \n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the code:\n\n```html\n<input type=\"hidden\" class=\"form-control\" name=\"product_id\" id=\"product_id\" value=\"<%= ejs.escape(product.id) %>\">\n```\n\nIn this version, the `ejs.escape()` function is used to escape the product id before including it into the HTML content.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "911a0992-8cf2-3177-a921-e93da1a121ca",
              "name": "XSS Vulnerability in User-Controlled HTML Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nCross-Site Scripting (XSS) vulnerabilities occur when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. XSS allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the application is redirecting the user to a new URL constructed by appending the user-supplied `req.url` to a base string. If an attacker can control the `req.url` value, they can potentially inject malicious scripts that will be executed in the context of the victim's session.\n\n## Mitigation Advice\n\nTo mitigate XSS vulnerabilities, you should:\n\n- Use frameworks that automatically escape XSS by design, such as Ruby on Rails, React JS, etc.\n- Escape untrusted HTTP request data based on the context in the HTML output (body, attribute, JavaScript, CSS, or URL) will resolve Reflected and Stored XSS vulnerabilities.\n- Apply context-sensitive encoding when modifying the browser document on the client side acts against DOM XSS.\n\n## Source Code Fix Recommendation\n\nIn the provided code snippet, you can mitigate the vulnerability by validating and sanitizing the `req.url` value before using it to construct the redirect URL. Here's an example using the `validator` library:\n\n```javascript\nvar validator = require('validator');\nvar returnUrl = validator.escape(req.url);\nres.redirect(\"/login?returnurl=\" + returnUrl);\n```\n\n## Library Dependencies\n\nThe code example requires the following library:\n\n- `validator`: A library of string validators and sanitizers.\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [OWASP DOM based XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "9d0fd56b-6a2f-33a0-80b4-adc854ddb132",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS (Embedded JavaScript) Template XSS (Cross-Site Scripting) Vulnerability is a security flaw that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the value of the hidden input field is being set using EJS templating syntax. If the `product.name` is not properly escaped, it can lead to XSS attacks.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always escape external data before including it in your HTML. In EJS, you can use `<%= %>` syntax to escape HTML entities. This will prevent any potentially harmful code from being executed.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of your code:\n\n```html\n<input type=\"hidden\" class=\"form-control\" name=\"product_name\" id=\"product_name\" value=\"<%= product.name %>\">\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "07c0380c-aba7-30c8-aeac-b46b3c52fcbe",
              "name": "The '/products/purchased' HTTP route in Express will manage get requests.",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe '/products/purchased' HTTP route in Express is vulnerable to potential security risks. The vulnerability lies in the fact that it does not validate or sanitize the user input before processing it. This can lead to various types of attacks such as SQL Injection, Cross-Site Scripting (XSS), and Remote Code Execution (RCE).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always validate and sanitize user inputs. This can be done using various methods such as using a validation library, using prepared statements for SQL queries, and encoding user inputs before rendering them.\n\n## Source Code Fix Recommendation\n\nHere is a recommended fix for the code:\n\n```javascript\nconst express = require('express');\nconst router = express.Router();\nconst db_products = require('./db_products');\nconst { body, validationResult } = require('express-validator');\n\nrouter.get('/products/purchased', [\n    body('user_name').trim().escape()\n], function(req, res, next) {\n\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n        return res.status(400).json({ errors: errors.array() });\n    }\n\n    check_logged(req, res);\n\n    db_products.getPurchased(req.session.user_name)\n        .then(function (data) {\n\n            console.log(data);\n            res.render('bought_products', { products: data });\n        })\n        .catch(function (err) {\n            console.log(err);\n\n            res.render('bought_products', { products: [] });\n        });\n});\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies to execute properly:\n\n- express\n- express-validator\n- db_products (Assuming it's a custom module for database operations)\n\n## OWASP and CWE Resources\n\n- [OWASP Input Validation Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)\n- [CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')](https://cwe.mitre.org/data/definitions/89.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)\n- [CWE-94: Improper Control of Generation of Code ('Code Injection')](https://cwe.mitre.org/data/definitions/94.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-89",
                    "url": "https://cwe.mitre.org/data/definitions/89.html"
                  },
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  },
                  {
                    "id": "CWE-94",
                    "url": "https://cwe.mitre.org/data/definitions/94.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-89",
                  "CWE-79",
                  "CWE-94"
                ]
              }
            },
            {
              "id": "68c1f7d8-4b69-3060-aaf9-85ccda4552a4",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS (Embedded JavaScript) Template XSS (Cross-Site Scripting) Vulnerability Detected Due to Unescaped External Data is a security vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape untrusted HTTP request data based on the context in the HTML output (body, attribute, JavaScript, CSS, or URL) will be consumed. Contextual output encoding/escaping of string input is a strong defense-in-depth coding technique to prevent XSS.\n\n## Source Code Fix Recommendation\n\nIn your specific code example, you are already using the `<%- %>` syntax which escapes HTML by default in EJS. This is the correct way to prevent XSS in EJS templates. If you were using `<%= %>` syntax, it would not escape HTML and would be vulnerable to XSS.\n\n```html\n<h4><a href=\"/products/detail?id=<%-product.id%>\"><%-product.name%></a></h4>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js\n- EJS\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "ec355622-fbf9-35b7-9d73-1c7912a5302f",
              "name": "The '/products/detail' HTTP route in Express will manage get requests.",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe '/products/detail' HTTP route in Express is vulnerable to Insecure Direct Object References (IDOR) attacks. This vulnerability occurs when an application provides direct access to objects based on user-supplied input. In this case, the application uses the product_id from the URL parameters to fetch product details from the database. An attacker can manipulate the product_id in the URL to access data they are not authorized to view.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should implement access control checks or use indirect object references. Access control checks ensure that the current user is authorized to access the requested object. Indirect object references map user-supplied input to internal objects without exposing their identifiers.\n\n## Source Code Fix\n\nHere is a fixed version of the code:\n\n```javascript\nrouter.get('/products/detail', function(req, res, next) {\n\n    check_logged(req, res);\n\n    var url_params = url.parse(req.url, true).query;\n\n    var product_id = url_params.id;\n\n    // Check if the user is authorized to access the product\n    if (isAuthorized(req.user, product_id)) {\n        db_products.getProduct(product_id)\n            .then(function (data) {\n                res.render('product_detail', { product: data });\n            })\n            .catch(function (err) {\n                console.log(err);\n\n                res.render('products', { products: [] });\n            });\n    } else {\n        res.status(403).send('Forbidden');\n    }\n});\n```\n\nIn this fixed version, the `isAuthorized` function checks if the current user is authorized to access the product with the given id. If the user is not authorized, the server responds with a 403 Forbidden status.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- express\n- url\n- a database library (e.g., mongoose for MongoDB, sequelize for SQL databases)\n\n## References\n\n- [OWASP Top 10 2017: A5-Broken Access Control](https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control)\n- [CWE-285: Improper Authorization](https://cwe.mitre.org/data/definitions/285.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-285",
                    "url": "https://cwe.mitre.org/data/definitions/285.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-285"
                ]
              }
            },
            {
              "id": "dee3bc56-a5d4-3c9a-9d6f-0b6ead96db9f",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, including crashes, and can potentially expose sensitive information in error messages.\n\nIn the provided code, the promise returned by `db_products.getPurchased(req.session.user_name)` is not handled properly. If the promise is rejected (for example, if there is a database error), there is no `.catch()` block to handle the error.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always handle promise rejections by adding a `.catch()` block to your promises. This block should handle the error appropriately, such as by logging the error and returning a generic error message to the user.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\ndb_products.getPurchased(req.session.user_name)\n    .then(function (data) {\n        console.log(data);\n        res.render('bought_products', { products: data });\n    })\n    .catch(function (error) {\n        console.error(error);\n        res.status(500).send('An error occurred');\n    });\n```\n\nIn this fixed code, if the promise is rejected, the `.catch()` block will catch the error, log it, and send a generic error message to the user.\n\n## Library Dependencies\n\nThe provided code appears to depend on the following libraries:\n\n- A database library (such as `pg-promise`) to provide the `db_products.getPurchased()` function.\n- Express.js for handling HTTP requests and responses (`req`, `res`).\n- A template engine (such as `ejs` or `pug`) for rendering the 'bought_products' view.\n\n## References\n\n- [OWASP Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "759b9b43-ace0-3e79-b8e2-1835f41f3645",
              "name": "'/' HTTP route in Express handles GET requests.",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe given code snippet is an Express.js route handler for the root URL (\"/\"). It handles GET requests by fetching a list of products from a database and rendering a view with these products. If an error occurs during the database operation, it logs the error and renders the view with an empty product list.\n\nThe potential vulnerability here is that the error details are logged to the console but not sent to the client. This could lead to information disclosure if the error details contain sensitive information about the system or the database. Additionally, the error handling is not robust and does not provide a meaningful response to the client.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should avoid logging sensitive information to the console or any other publicly accessible logs. Instead, log errors to a secure, private error tracking system. Also, improve the error handling to provide a meaningful response to the client without revealing sensitive information.\n\n## Source Code Fix Recommendation\n\nHere's a recommended fix for the code:\n\n```javascript\nrouter.get('/', function(req, res, next) {\n\n    check_logged(req, res);\n\n    db_products.list()\n        .then(function (data) {\n            res.render('products', { products: data });\n        })\n        .catch(function (err) {\n            // Log the error to a secure, private error tracking system\n            secureLog(err);\n\n            // Render an error page or a generic message to the client\n            res.status(500).send('An error occurred while fetching products. Please try again later.');\n        });\n});\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js\n- A database library compatible with the `db_products.list()` method (the specific library is not indicated in the code)\n\n## References\n\n- [OWASP Top 10 - A3:2017-Sensitive Data Exposure](https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure)\n- [CWE-209: Information Exposure Through an Error Message](https://cwe.mitre.org/data/definitions/209.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-209",
                    "url": "https://cwe.mitre.org/data/definitions/209.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-209"
                ]
              }
            },
            {
              "id": "5febceca-57c3-3ab2-97a5-b5bcad560a47",
              "name": "Unescaped EJS Template Detected, Exposing Potential XSS Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"Unescaped EJS Template Detected, Exposing Potential XSS Vulnerability\" is a security vulnerability that occurs when user input is directly embedded into HTML without proper sanitization or escaping. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. In this case, the vulnerability is in the EJS (Embedded JavaScript) template engine used in Node.js applications.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape user input that is embedded into HTML. This can be done using the `<%- %>` syntax in EJS, which automatically escapes HTML characters. Never use the `<%= %>` syntax, which does not escape HTML characters.\n\n## Source Code Fix Recommendation\n\nThe provided code snippet is already using the `<%- %>` syntax, which means it is correctly escaping the `product.description` variable. If it was using the `<%= %>` syntax, it would need to be changed to `<%- %>` to fix the vulnerability.\n\n```html\n<p><%- product.description %></p>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- `ejs`: The Embedded JavaScript template engine.\n\n## OWASP Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n\n## Common Weakness Enumeration (CWE)\n\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "2daa9317-dd3f-3b67-9c9a-38c52bff7e3c",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\nIn the provided code snippet, the vulnerability exists because the EJS template engine is used to render data directly into the HTML without proper escaping. This means that if the `product.price` variable contains malicious script, it will be executed in the user's browser.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always escape untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. In EJS, you can use `<%= %>` syntax to output the value as an escaped string.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code snippet:\n\n```html\n<h4 class=\"pull-right\"><%=product.price%>?</h4>\n```\n\nIn this version, `<%= %>` is used instead of `<%- %>`, which means that the output will be escaped.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- Express.js\n- EJS\n\n## References\n\n- [OWASP Cross Site Scripting Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "651f5d73-053c-35d1-9f19-7c7d0ae98773",
              "name": "'Get' requests managed by '/products/search' HTTP route in Express.",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe code snippet provided is an Express.js route handler for GET requests to '/products/search'. The vulnerability lies in the fact that the user input from the query parameter 'q' is directly used in a database search operation without any sanitization or validation. This could potentially lead to NoSQL injection attacks if the application is using a NoSQL database like MongoDB.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always validate and sanitize user inputs before using them in any database operations. This can be achieved by using validation libraries like 'validator' or 'joi'. Also, if the application is using a NoSQL database, it is recommended to use parameterized queries or prepared statements to prevent NoSQL injection attacks.\n\n## Source Code Fix\n\nHere is a recommended fix for the code using the 'validator' library to sanitize the user input:\n\n```javascript\nvar validator = require('validator');\n\nrouter.get('/products/search', function(req, res, next) {\n\n    check_logged(req, res);\n\n    var url_params = url.parse(req.url, true).query;\n    var query = validator.escape(url_params.q);\n\n    if (query == undefined) {\n        res.render('search', { in_query: \"\", products: [] });\n        return;\n    }\n\n    db_products.search(query)\n        .then(function (data) {\n\n            res.render('search', { in_query: query, products: data });\n        })\n        .catch(function (err) {\n\n            console.log(err);\n\n            res.render('search', { in_query: query, products: [] });\n        });\n\n});\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies to execute properly:\n\n- express\n- url\n- validator (for the fixed code)\n\n## References\n\n- [OWASP Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html)\n- [CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')](https://cwe.mitre.org/data/definitions/89.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-89",
                    "url": "https://cwe.mitre.org/data/definitions/89.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-89"
                ]
              }
            },
            {
              "id": "77bb697b-b61c-3d01-8a4b-c0e1aadcf09b",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to:\n\n- Always validate user input: Use a secure function to validate user input and reject any input that may contain malicious scripts.\n- Escape untrusted HTTP request data: Use appropriate context-dependent escaping on all untrusted data before using it to generate HTML content.\n- Use secure default settings: Libraries or frameworks that provide a secure default configuration can help protect against XSS vulnerabilities.\n\n## Source Code Fix Recommendation\n\nIn the provided code snippet, the `in_query` variable is not properly escaped, which can lead to XSS attacks. To fix this, you should use `<%= %>` instead of `<%- %>`. The `<%= %>` syntax in EJS escapes the output.\n\n```javascript\n<h2>Results for: <%= in_query %></h2>\n```\n\n## Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "444f5d48-a65a-3fcf-94a3-cbbab02c71c6",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nUnhandled Promise Rejection Vulnerability in JavaScript occurs when a promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, crashes, and potential security vulnerabilities. In the provided code, the promise returned by `db_products.list()` is not being handled for a case where it might get rejected.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always include a `.catch()` block when working with promises to handle any errors that may occur. This allows you to control the application flow even when things go wrong, and prevent any sensitive information leakage or unexpected application behavior.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\ndb_products.list()\n    .then(function (data) {\n        res.render('products', { products: data });\n    })\n    .catch(function (error) {\n        // Handle the error here\n        console.error(error);\n        res.status(500).send('An error occurred');\n    });\n```\n\nIn this fixed code, if the promise returned by `db_products.list()` is rejected, the `.catch()` block will catch the error and handle it.\n\n## Library Dependencies\n\nThe code seems to be using some kind of database library for `db_products.list()` and an express-like library for `res.render()`. However, without more context, it's hard to say exactly which libraries are being used.\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "a3213458-14c4-340c-a99b-a6d332a35ec6",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"Unhandled Promise Rejection Vulnerability\" in JavaScript occurs when a Promise is rejected, but this rejection is not caught or handled. This can lead to unexpected application behavior, including crashes, and can potentially expose sensitive information in error messages.\n\nIn the provided code, the Promise returned by `db_products.search(query)` is not being handled for a case where it might get rejected. If the Promise is rejected, it will throw an error that is not caught, leading to potential application instability or exposure of sensitive information.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always handle Promise rejections. This can be done by adding a `.catch()` block to the Promise chain. The `.catch()` block will catch any errors that occur in the Promise chain and allow you to handle them appropriately.\n\n## Source Code Fix Recommendation\n\nHere is how you can fix the provided code:\n\n```javascript\ndb_products.search(query)\n    .then(function (data) {\n        res.render('search', { in_query: query, products: data });\n    })\n    .catch(function (error) {\n        // Handle the error appropriately\n        console.error(error);\n        res.status(500).send('An error occurred while searching the products');\n    });\n```\n\nIn this fixed code, if the Promise returned by `db_products.search(query)` is rejected, the error will be caught and logged to the console, and a 500 response will be sent.\n\n## Library Dependencies\n\nThe provided code seems to be using the following libraries:\n\n- A database library that provides the `db_products.search()` function. The exact library is not specified in the code.\n- Express.js for handling HTTP requests and responses. This is indicated by the use of `res.render()` and `res.status().send()`.\n\n## References\n\n- [OWASP Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "e4feccd5-cb87-31a5-91f1-82c98fbc42a9",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application uses untrusted data in the EJS template engine without proper validation or escaping. This allows attackers to inject malicious scripts into the web page, which will be executed in the browser of any user viewing that page. This is a type of Cross-Site Scripting (XSS) vulnerability.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data is placed into. In EJS, the `<%- %>` tags are used to output unescaped, raw data, while `<%= %>` tags are used to output HTML escaped data.\n\n## Source Code Fix Recommendation\n\nReplace `<%- %>` with `<%= %>` to escape the data:\n\n```javascript\n<td><%= products[i].price %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS (Embedded JavaScript templates)\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "c51e2121-42b6-3458-9e73-d04dc903f5fb",
              "name": "Sensitive Data Exposure in API Response",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nSensitive Data Exposure in API Response is a vulnerability that occurs when an application unintentionally exposes sensitive data in its responses. This can happen when an application does not properly protect sensitive data, such as credit card numbers, social security numbers, or user credentials, in its responses. Attackers can exploit this vulnerability to gain unauthorized access to sensitive data, which can lead to identity theft, financial loss, or other serious consequences.\n\nIn JavaScript, this vulnerability can occur when sensitive data is included in JSON responses without proper protection. For example, if an application returns a JSON response that includes a user's password, an attacker could potentially intercept this response and gain access to the user's password.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should:\n\n- Never include sensitive data in your responses unless absolutely necessary.\n- Always use secure connections (HTTPS) to transmit sensitive data.\n- Implement proper access controls to ensure that only authorized users can access sensitive data.\n- Encrypt sensitive data before including it in your responses.\n\n## Source Code Fix Recommendation\n\nIn the provided code example, no sensitive data is being exposed in the API response. Therefore, no fix is necessary. However, if the response did include sensitive data, you could protect it by encrypting it before including it in the response. Here's an example of how you could do this using the `crypto` library:\n\n```javascript\nconst crypto = require('crypto');\n\n// Encrypt sensitive data\nconst sensitiveData = '...'; // Replace with your sensitive data\nconst cipher = crypto.createCipher('aes-256-cbc', 'a password');\nlet encrypted = cipher.update(sensitiveData, 'utf8', 'hex');\nencrypted += cipher.final('hex');\n\n// Include encrypted data in response\nreturn res.json({message: \"Product purchased correctly\", data: encrypted});\n```\n\n## Library Dependencies\n\nThe provided code example requires the `express` library to create the API and handle responses.\n\n## References\n\n- [OWASP Top 10 - A3:2017-Sensitive Data Exposure](https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure)\n- [CWE-200: Information Exposure](https://cwe.mitre.org/data/definitions/200.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-200",
                    "url": "https://cwe.mitre.org/data/definitions/200.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-200"
                ]
              }
            },
            {
              "id": "c19f6270-1090-3260-8793-90341df3a4a7",
              "name": "Unhandled Promise Rejection Vulnerability",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"Unhandled Promise Rejection Vulnerability\" in JavaScript occurs when a Promise is rejected, but there is no error handling mechanism in place to catch and handle the error. This can lead to unexpected application behavior, including crashes, and can potentially expose sensitive information in error messages.\n\nIn the provided code, the Promise returned by `db_products.getProduct(product_id)` is not being handled for a case where it might get rejected. If the Promise is rejected, there is no `.catch()` block to handle the error, which could lead to an Unhandled Promise Rejection.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, you should always handle Promise rejections by adding a `.catch()` block to your Promise chains. This block should contain appropriate error handling logic. In addition, avoid throwing errors from within a `.catch()` block, as this can lead to further unhandled rejections.\n\n## Source Code Fix Recommendation\n\nHere is a recommended fix for the provided code:\n\n```javascript\ndb_products.getProduct(product_id)\n    .then(function (data) {\n        res.render('product_detail', { product: data });\n    })\n    .catch(function (error) {\n        // Handle the error appropriately here\n        console.error(error);\n        res.status(500).send('An error occurred');\n    });\n```\n\nIn this fixed code, a `.catch()` block has been added to handle any errors that occur when trying to get the product.\n\n## Library Dependencies\n\nThe provided code appears to be using Express.js for handling HTTP requests and responses, and some kind of database library for fetching product data. The exact libraries required will depend on the specifics of your application.\n\n## References\n\n- [OWASP - Unhandled Promise Rejection](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_security_cheat_sheet.html#unhandled-promise-rejections)\n- [CWE-754: Improper Check for Unusual or Exceptional Conditions](https://cwe.mitre.org/data/definitions/754.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-754",
                    "url": "https://cwe.mitre.org/data/definitions/754.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-754"
                ]
              }
            },
            {
              "id": "53909f58-2f54-3c2d-a174-9d2ecc6a8fd4",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application uses untrusted data in the EJS template engine without proper validation or escaping. This allows an attacker to inject malicious scripts into the web page, which will be executed in the browser of any user viewing the page. This type of attack is known as Cross-Site Scripting (XSS).\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape untrusted data and never insert untrusted data directly into the HTML document. This can be done by using the `<%= %>` syntax in EJS, which automatically escapes the output.\n\n## Source Code Fix Recommendation\n\nThe provided code snippet can be fixed by replacing `<%- i + 1 %>` with `<%= i + 1 %>`. This will ensure that the output is properly escaped.\n\n```javascript\n<td><%= i + 1 %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating engine.\n\n## References\n\n- [OWASP XSS Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "e99dca15-8054-30dd-ab36-5b2b69d15420",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\nThe EJS (Embedded JavaScript) Template XSS (Cross-Site Scripting) Vulnerability Detected Due to Unescaped External Data is a security flaw that occurs when an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. This allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape untrusted data based on the HTML context (body, attribute, JavaScript, CSS, or URL) that the data will be placed into. \n\n## Source Code Fix Recommendation\n\nIn the provided code snippet, the `i + 1` is being output directly into HTML without any form of escaping. This can be fixed by using the `<%= %>` syntax which automatically escapes the output:\n\n```javascript\n<td><a href=\"/products/detail?id=<%= i + 1 %>\"><i class=\"glyphicon glyphicon-list\"></i></a></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A simple templating language that lets you generate HTML markup with plain JavaScript.\n\n## References\n\n- [OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "bb6ea644-4322-345f-b90a-a9baf6a7ea35",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when an application uses untrusted data in the EJS template engine without proper validation or escaping. This allows an attacker to inject malicious scripts into the web page, which will be executed in the browser of any user viewing that page. This is a type of Cross-Site Scripting (XSS) vulnerability.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, it is recommended to always escape untrusted data before including it in an HTML context. This can be done using the `<%= %>` syntax in EJS, which automatically escapes the output.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code:\n\n```javascript\n<td><%= products[i].name %></td>\n```\n\nIn this version, the `<%= %>` syntax is used instead of `<%- %>`, which ensures that the output is properly escaped.\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating engine used to generate HTML markup with plain JavaScript.\n\n## OWASP and CWE Resources\n\n- [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-community/attacks/xss/)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            },
            {
              "id": "66ed0e4d-548b-384c-830a-a4604d8a721f",
              "name": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data",
              "helpUri": "https://www.glog.ai/",
              "help": {
                "text": "",
                "markdown": "## Description\n\n\"EJS Template XSS Vulnerability Detected Due to Unescaped External Data\" is a vulnerability that occurs when unescaped external data is used in an EJS template. This can lead to Cross-Site Scripting (XSS) attacks, where an attacker can inject malicious scripts into web pages viewed by other users. These scripts can steal sensitive information, perform actions on behalf of the user, or exploit other vulnerabilities in the user's browser.\n\nIn the provided code snippet, the vulnerability arises from the use of `<%- products[i].description %>`. This syntax in EJS templates outputs the unescaped content of `products[i].description`, which means any HTML or JavaScript code in the description will be executed when the page is rendered.\n\n## Mitigation Advice\n\nTo mitigate this vulnerability, always escape external data before including it in your templates. This can be done using the `<%= %>` syntax in EJS, which automatically escapes HTML characters.\n\n## Source Code Fix Recommendation\n\nHere is the fixed version of the provided code snippet:\n\n```javascript\n<td><%= products[i].description %></td>\n```\n\n## Library Dependencies\n\nThe code example requires the following library dependencies:\n\n- EJS: A JavaScript templating engine used to generate HTML markup with plain JavaScript.\n\n## References\n\n- [OWASP Cross Site Scripting Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)\n- [CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')](https://cwe.mitre.org/data/definitions/79.html)"
              },
              "properties": {
                "cwe": [
                  {
                    "id": "CWE-79",
                    "url": "https://cwe.mitre.org/data/definitions/79.html"
                  }
                ],
                "severity": "MEDIUM",
                "kind": "FAIL",
                "tags": [
                  "CWE-79"
                ]
              }
            }
          ],
          "language": "en-US",
          "contents": [
            "localizedData",
            "nonLocalizedData"
          ],
          "isComprehensive": false
        }
      },
      "language": "en-US",
      "results": [
        {
          "ruleId": "06bbf79d-b014-3d8f-9474-ab242201bf88",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Default Session Cookie Name Vulnerability\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "app.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 9,
                  "endLine": 49,
                  "endColumn": 3,
                  "snippet": {
                    "text": "app.use(session({\n  secret: 'asddfilhpaf78h78032h780g780fg780asg780dsbovncubuyvqy',\n  cookie: {\n    secure: false,\n    maxAge: 99999999999\n  }\n}));"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "e88f6a7fd9d1b37d22c644efd37e33ec1048f53ccbf2fb55aaecb25c917729c5",
            "glog-pfp-ruleFileCode/v1": "cd0667ae69c6685f0ad59c4cf1ffcb5a613df6d5ea012f80808eb09aa1483fc4"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "cd0667ae69c6685f0ad59c4cf1ffcb5a613df6d5ea012f80808eb09aa1483fc4"
          },
          "properties": {}
        },
        {
          "ruleId": "31beb584-8207-362f-8d9c-740010883040",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "URI Contains Username and Password Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "config.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 12,
                  "startColumn": 20,
                  "endLine": 12,
                  "endColumn": 63,
                  "snippet": {
                    "text": "        \"server\": \"postgres://postgres:postgres@10.211.55.70\","
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "871afc4ff17c7dc22c08071d0912c233770bbbe9f26bd61a2ab77ca8507362bf",
            "glog-pfp-ruleFileCode/v1": "5211184579120425462fbafd6822895b3fa366c1043aa289c502f26d6a1afb3a"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "5211184579120425462fbafd6822895b3fa366c1043aa289c502f26d6a1afb3a"
          },
          "properties": {}
        },
        {
          "ruleId": "90961217-37f2-37be-84dc-eef19c99fc59",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "dummy.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 20,
                  "startColumn": 25,
                  "endLine": 20,
                  "endColumn": 38,
                  "snippet": {
                    "text": "      \"price\": parseInt(Math.random() * 100),"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "6c97da4459387a3e0376a42e481b4939c3d040c0e66bbca5b1f645b549199f37",
            "glog-pfp-ruleFileCode/v1": "b9359a3c568750f5fc52a3b79efcc2a0c1a6f965ebba08b97d99c30bc4b38a59"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "b9359a3c568750f5fc52a3b79efcc2a0c1a6f965ebba08b97d99c30bc4b38a59"
          },
          "properties": {}
        },
        {
          "ruleId": "201f005c-dbaa-35bf-9d0a-70aa254a89e1",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "dummy.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 26,
                  "startColumn": 25,
                  "endLine": 26,
                  "endColumn": 38,
                  "snippet": {
                    "text": "      \"price\": parseInt(Math.random() * 100),"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "6e6bda4b4502e311cf683a10ac5862b669811f07d8fa2e15fb222b5aea376102",
            "glog-pfp-ruleFileCode/v1": "e0ff5c4426ac09d7421f2a3f2fd9fc9cc6468513477df1961439d00ebce338d0"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "e0ff5c4426ac09d7421f2a3f2fd9fc9cc6468513477df1961439d00ebce338d0"
          },
          "properties": {}
        },
        {
          "ruleId": "0c6519c5-cb1d-3522-88e6-11de7eb64770",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "dummy.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 25,
                  "endLine": 32,
                  "endColumn": 38,
                  "snippet": {
                    "text": "      \"price\": parseInt(Math.random() * 100),"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "1052ff10982e5d58400a1ec929d2745ec20b8c4cedbd5bb3301a7313c875abed",
            "glog-pfp-ruleFileCode/v1": "a6895bb91e937bb551ff0e7baf991213e9a5484ea5a4bb5e92089a5fed66687c"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "a6895bb91e937bb551ff0e7baf991213e9a5484ea5a4bb5e92089a5fed66687c"
          },
          "properties": {}
        },
        {
          "ruleId": "ef867e0a-cae2-3a7d-8b4c-e8b3ed3a5d6a",
          "kind": "fail",
          "level": "error",
          "message": {
            "text": "High-Risk Dockerfile Vulnerability: Improper Use of MAINTAINER Directive"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "services/postgresql/Dockerfile",
                  "uriBaseId": "ROOTPATH"
                },
                "region": {
                  "startLine": 3,
                  "startColumn": 1,
                  "endLine": 3,
                  "endColumn": 1,
                  "snippet": {
                    "text": "MAINTAINER \"Daniel Garcia aka (cr0hn)\" <cr0hn@cr0hn.com>"
                  }
                }
              },
              "message": {
                "text": "services/postgresql/Dockerfile"
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "4eb6381fbae20a8490751846ab7af1b45c9a6e9f008ad6e4ef10e8ff81c8a122",
            "glog-pfp-ruleFileCode/v1": "4e77b9c9ddc7147b21cc5fca0699d20ecdeb23b42219979fbfd25ef6107fc590"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "4e77b9c9ddc7147b21cc5fca0699d20ecdeb23b42219979fbfd25ef6107fc590"
          }
        },
        {
          "ruleId": "beccad8a-68ff-3625-8af6-43e6f5112e1f",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Missing CSRF Middleware in Express Application\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "app.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 16,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 20,
                  "snippet": {
                    "text": "var app = express();"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "a439b1f960890d0a65ed45595cbd5fde86cebeba403fd745bd94a7e16de8f608",
            "glog-pfp-ruleFileCode/v1": "6d9ffb9103267a56d5cc6233aa7ae17f91e572ecb245400a293d353842284883"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "6d9ffb9103267a56d5cc6233aa7ae17f91e572ecb245400a293d353842284883"
          },
          "properties": {}
        },
        {
          "ruleId": "3da8c3ba-74c7-3cf4-9ce5-863862d3d245",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "dummy.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 50,
                  "startColumn": 25,
                  "endLine": 50,
                  "endColumn": 38,
                  "snippet": {
                    "text": "      \"price\": parseInt(Math.random() * 100),"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "170ac4e5b6e368c256986793c63ebb30f8d59b638ac4908d68d183ae55972626",
            "glog-pfp-ruleFileCode/v1": "f357e70c982b6366f30d96f9917975307ae8481d281fea4661e7df0747e2b201"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "f357e70c982b6366f30d96f9917975307ae8481d281fea4661e7df0747e2b201"
          },
          "properties": {}
        },
        {
          "ruleId": "9308eb1d-519b-3433-a641-d43c70242e99",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "dummy.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 56,
                  "startColumn": 25,
                  "endLine": 56,
                  "endColumn": 38,
                  "snippet": {
                    "text": "      \"price\": parseInt(Math.random() * 100),"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "6acf3d8fced64862ad6a3b24f5bafe1c22fa38cd1e8aaed442f3bf6bbf2a6e4d",
            "glog-pfp-ruleFileCode/v1": "481f51dc249faf9b2508d6b98f92da8ab90d49d625699a5425226f039eb24e5e"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "481f51dc249faf9b2508d6b98f92da8ab90d49d625699a5425226f039eb24e5e"
          },
          "properties": {}
        },
        {
          "ruleId": "5376f6e2-af4e-3bff-9a5f-9ccb19239bf3",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Crypto.pseudoRandomBytes()/Math.random() exhibits cryptographic weakness.\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "dummy.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 62,
                  "startColumn": 25,
                  "endLine": 62,
                  "endColumn": 38,
                  "snippet": {
                    "text": "      \"price\": parseInt(Math.random() * 100),"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "adfbca012577593e8f7f592f510b507663f9c1977079cb579b743041cb3d6a9a",
            "glog-pfp-ruleFileCode/v1": "e500160190c3db2e9cc0ee4e6715d3206b32fd66b7afee40c3ce22729438ad60"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "e500160190c3db2e9cc0ee4e6715d3206b32fd66b7afee40c3ce22729438ad60"
          },
          "properties": {}
        },
        {
          "ruleId": "2aa33ec3-ed30-3b51-961e-03b18b59ff4b",
          "kind": "fail",
          "level": "error",
          "message": {
            "text": "\"Dockerfile Vulnerability: Missing '--no-install-recommends' Flag in 'apt-get' Command\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "Dockerfile",
                  "uriBaseId": "ROOTPATH"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 1,
                  "endLine": 7,
                  "endColumn": 1,
                  "snippet": {
                    "text": "RUN apt-get update && apt-get install -y netcat"
                  }
                }
              },
              "message": {
                "text": "Dockerfile"
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "d24d01d407d4c575cf2afab1b29f6ffbf677f832c5e9f85cd5bf939e0bfa53cc",
            "glog-pfp-ruleFileCode/v1": "85df6e4145c98c969c1ba78566d405153a998277576ad8ab78c6e142978b2a66"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "85df6e4145c98c969c1ba78566d405153a998277576ad8ab78c6e142978b2a66"
          }
        },
        {
          "ruleId": "857685af-565e-3914-be90-24868f24eb92",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Detected Generic Secret Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "app.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 44,
                  "startColumn": 3,
                  "endLine": 44,
                  "endColumn": 65,
                  "snippet": {
                    "text": "  secret: 'asddfilhpaf78h78032h780g780fg780asg780dsbovncubuyvqy',"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "fdb5e1cc9ccada5084ad70be9b627d0dc338bdbfa671229a0c11975764b1851d",
            "glog-pfp-ruleFileCode/v1": "290e2e2cb88af7d7cd8aecc0e6d1c91530957f0913ca2a001087ea67aa07fb1e"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "290e2e2cb88af7d7cd8aecc0e6d1c91530957f0913ca2a001087ea67aa07fb1e"
          },
          "properties": {}
        },
        {
          "ruleId": "1211fffb-8d42-3097-b15b-3804852e1872",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "URI Contains Username and Password Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "config.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 4,
                  "startColumn": 20,
                  "endLine": 4,
                  "endColumn": 60,
                  "snippet": {
                    "text": "        \"server\": \"postgres://postgres:postgres@127.0.0.1\","
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "80119e3a0671acc53851dd33119bba9b62e99ebbde386b21290ceecd6ca95460",
            "glog-pfp-ruleFileCode/v1": "bcf8e045a1562d2627759e7d87eeb6f658dfa66850e2d4822cc2a8f0967252c5"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "bcf8e045a1562d2627759e7d87eeb6f658dfa66850e2d4822cc2a8f0967252c5"
          },
          "properties": {}
        },
        {
          "ruleId": "67087029-2640-34fb-9f38-289b0f9dc639",
          "kind": "fail",
          "level": "error",
          "message": {
            "text": "High-Risk Dockerfile Vulnerability: Lack of Non-Root User Specification"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "services/postgresql/Dockerfile",
                  "uriBaseId": "ROOTPATH"
                },
                "region": {
                  "startLine": 1,
                  "startColumn": 1,
                  "endLine": 1,
                  "endColumn": 1,
                  "snippet": {
                    "text": "FROM postgres:15.1-bullseye"
                  }
                }
              },
              "message": {
                "text": "services/postgresql/Dockerfile"
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "c11c7ac6fc984588d08f9b866e4793ada4703e472646c266acb644503e9fa5c7",
            "glog-pfp-ruleFileCode/v1": "c2a1c5513b75120a8e5df18b078163b95fb3191df1f1fa86bc35858e07f13245"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "c2a1c5513b75120a8e5df18b078163b95fb3191df1f1fa86bc35858e07f13245"
          }
        },
        {
          "ruleId": "09f87833-7816-324f-9eba-159ae7844489",
          "kind": "fail",
          "level": "error",
          "message": {
            "text": "High-Risk Dockerfile Vulnerability: Lack of Non-Root User Specification"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "Dockerfile",
                  "uriBaseId": "ROOTPATH"
                },
                "region": {
                  "startLine": 1,
                  "startColumn": 1,
                  "endLine": 1,
                  "endColumn": 1,
                  "snippet": {
                    "text": "FROM node:19.4.0-bullseye-slim"
                  }
                }
              },
              "message": {
                "text": "Dockerfile"
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "876020295e104847e64014abca4a48357432a458a60f8e602a50483b7580a40f",
            "glog-pfp-ruleFileCode/v1": "84dd05a76d8dd1aa45f8cd75371418e2bf81fe471a27bde9a727b422e091b8ff"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "84dd05a76d8dd1aa45f8cd75371418e2bf81fe471a27bde9a727b422e091b8ff"
          }
        },
        {
          "ruleId": "ba370b09-7185-322d-8cf7-998c410dacf4",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/init_db.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 15,
                  "startColumn": 5,
                  "endLine": 17,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db.one('CREATE TABLE users(name VARCHAR(100) PRIMARY KEY, password VARCHAR(50));')\n        .then(function () {\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "cef505f4611be6b1d6a2effe13648b7ecf02ad80dcdcddea26c9959be2b9c821",
            "glog-pfp-ruleFileCode/v1": "cfcf567f9055354dc59c56bdb6851137aff97b2a4068ef0a4a28249d5033bedd"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "cfcf567f9055354dc59c56bdb6851137aff97b2a4068ef0a4a28249d5033bedd"
          },
          "properties": {}
        },
        {
          "ruleId": "178c673e-0418-30d2-af05-2976663a00ae",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/auth.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 7,
                  "startColumn": 5,
                  "endLine": 7,
                  "endColumn": 100,
                  "snippet": {
                    "text": "    var q = \"SELECT * FROM users WHERE name = '\" + username + \"' AND password ='\" + password + \"';\";"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "c0e6eabe377ba29552e99ced7183494b8ff12f82076d082364bdd413674df515",
            "glog-pfp-ruleFileCode/v1": "1484ec40ce17297746e78cbc567b2c38773f44f494862a99ebdc9579388be0a5"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "1484ec40ce17297746e78cbc567b2c38773f44f494862a99ebdc9579388be0a5"
          },
          "properties": {}
        },
        {
          "ruleId": "acb8f5a9-af8e-3940-a463-8c7d6d4c3700",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/init_db.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 5,
                  "endLine": 37,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db.one('CREATE TABLE products(id INTEGER PRIMARY KEY, name VARCHAR(100) not null, description TEXT not null, price INTEGER, image VARCHAR(500))')\n        .then(function () {\n\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "a45f1a819bf0013a4c79fa077449d4a192c5b893dc506bb5888458da613ead92",
            "glog-pfp-ruleFileCode/v1": "f2d4d251f3514d79e9df5794b1804aac93702f8eeb76c3bc1fbd1ea295324b4f"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "f2d4d251f3514d79e9df5794b1804aac93702f8eeb76c3bc1fbd1ea295324b4f"
          },
          "properties": {}
        },
        {
          "ruleId": "ce3b97d0-f97d-367b-a7ce-27c024f46a63",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 26,
                  "startColumn": 17,
                  "endLine": 26,
                  "endColumn": 46,
                  "snippet": {
                    "text": "            <td><%- products[i].product_id %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "65f6eac98a4e0fd916ef63f133f585637d60d8f5881e810fea18e287bcb43886",
            "glog-pfp-ruleFileCode/v1": "573b63d2c7384a8dbc7f0a8df0b9a95c3a0dfb2b2b085d7d9337568081473ee8"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "573b63d2c7384a8dbc7f0a8df0b9a95c3a0dfb2b2b085d7d9337568081473ee8"
          },
          "properties": {}
        },
        {
          "ruleId": "59392c6a-966e-3b61-85a9-40f991b54abe",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/init_db.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 17,
                  "endLine": 27,
                  "endColumn": 23,
                  "snippet": {
                    "text": "                db.one('INSERT INTO users(name, password) values($1, $2)', [u.username, u.password])\n                    .then(function () {\n                        // success;\n                    })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "fc09278be3559b218d4a6d01f73c16f0fe2bca97f2c984f7e86bef1c5cf74cc7",
            "glog-pfp-ruleFileCode/v1": "d82d9de76e6f909457e7550137d1a1bc3906148656ad12b9b7c521c9f2449a74"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "d82d9de76e6f909457e7550137d1a1bc3906148656ad12b9b7c521c9f2449a74"
          },
          "properties": {}
        },
        {
          "ruleId": "4277e1ab-3400-3e82-a03c-0bddbe910173",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/init_db.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 17,
                  "endLine": 48,
                  "endColumn": 23,
                  "snippet": {
                    "text": "                db.one('INSERT INTO products(id, name, description, price, image) values($1, $2, $3, $4, $5)', [i, p.name, p.description, p.price, p.image])\n                    .then(function () {\n                        // success;\n                    })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "67793ecf66652c0b8097a84b8d4b61b1401cc21c8808097214e964c4fa3eba51",
            "glog-pfp-ruleFileCode/v1": "0512e4cd0b5f3db00c492880892526d25993967786c4cb9959ae9eaa6a6fd45a"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "0512e4cd0b5f3db00c492880892526d25993967786c4cb9959ae9eaa6a6fd45a"
          },
          "properties": {}
        },
        {
          "ruleId": "f796643e-3578-3cbe-957a-4bfd94543d18",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Unvalidated User-Supplied URL Redirection Vulnerability\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 36,
                  "startColumn": 26,
                  "endLine": 36,
                  "endColumn": 35,
                  "snippet": {
                    "text": "            res.redirect(returnurl);"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "4dae245d54b262263a8c6ba2798db1141e0b625f364bcac316ec0ad652f9658f",
            "glog-pfp-ruleFileCode/v1": "cc7d9adcb87006640da4666e5cfcc2f1cc1a554f4ae82d510e017321a69fbfa8"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "cc7d9adcb87006640da4666e5cfcc2f1cc1a554f4ae82d510e017321a69fbfa8"
          },
          "properties": {}
        },
        {
          "ruleId": "8310b3ee-01cc-37f9-89f8-3b6f896f30d6",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 28,
                  "startColumn": 17,
                  "endLine": 28,
                  "endColumn": 40,
                  "snippet": {
                    "text": "            <td><%- products[i].mail %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "984dee8c6df916fe88fbb08fb0d69d7034f54ded6333ce2d7eeb951d92a82c46",
            "glog-pfp-ruleFileCode/v1": "4d75cf10b0bb48b4a2133ee5ad08d31f0a60cf3209d6820ca58f3bf877917a47"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "4d75cf10b0bb48b4a2133ee5ad08d31f0a60cf3209d6820ca58f3bf877917a47"
          },
          "properties": {}
        },
        {
          "ruleId": "56725a66-eb4c-302e-8dac-05fba34b55f3",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 14,
                  "startColumn": 5,
                  "endLine": 14,
                  "endColumn": 70,
                  "snippet": {
                    "text": "    var q = \"SELECT * FROM products WHERE id = '\" + product_id + \"';\";"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "36b076861b75cff54d90d3859aa99d9a72edee9774b0dc4f9efe773aabe6d018",
            "glog-pfp-ruleFileCode/v1": "51d3947a0f78375b7d8c025930622b42607273b0a5afcc1dbd2ba12032bea474"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "51d3947a0f78375b7d8c025930622b42607273b0a5afcc1dbd2ba12032bea474"
          },
          "properties": {}
        },
        {
          "ruleId": "948a5476-80ea-395c-a62c-e1c1b5a7a750",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 27,
                  "startColumn": 17,
                  "endLine": 27,
                  "endColumn": 48,
                  "snippet": {
                    "text": "            <td><%- products[i].product_name %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "7671eebb4ec501a7df5738415d7e0801f54a3cbfd901b9ffeb5870f51ca517c0",
            "glog-pfp-ruleFileCode/v1": "61f9046ee709ac6c1f42fa8e5e2238b91fd865ec243f7b002e989b326ff6d9d6"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "61f9046ee709ac6c1f42fa8e5e2238b91fd865ec243f7b002e989b326ff6d9d6"
          },
          "properties": {}
        },
        {
          "ruleId": "e48f1e07-034c-373e-933a-23522af18936",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 29,
                  "startColumn": 17,
                  "endLine": 29,
                  "endColumn": 41,
                  "snippet": {
                    "text": "            <td><%- products[i].phone %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "8ea5fc45dbb82bf446aca24c47eff9d3c26b10d7c391b156566c7ce2fdfb6195",
            "glog-pfp-ruleFileCode/v1": "6da25b514804a8613294d984f2ab790c9ef2f504676e142fec7098d2287b1360"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "6da25b514804a8613294d984f2ab790c9ef2f504676e142fec7098d2287b1360"
          },
          "properties": {}
        },
        {
          "ruleId": "688d7e11-f151-3845-b990-6543df5eb742",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 21,
                  "startColumn": 5,
                  "endLine": 21,
                  "endColumn": 112,
                  "snippet": {
                    "text": "    var q = \"SELECT * FROM products WHERE name ILIKE '%\" + query + \"%' OR description ILIKE '%\" + query + \"%';\";"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "fafd34a68a00dac62146e8c3e3f78c6c8c9b2796adf43bfeecfd564f4876de31",
            "glog-pfp-ruleFileCode/v1": "8f77b19847e6721badee6215a3981fb419aa363bd15c754895b59c65a4dda65c"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "8f77b19847e6721badee6215a3981fb419aa363bd15c754895b59c65a4dda65c"
          },
          "properties": {}
        },
        {
          "ruleId": "9e411e04-d8ca-3bf8-ac54-e7db7be5ee03",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/init_db.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 5,
                  "endLine": 58,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db.one('CREATE TABLE purchases(id SERIAL PRIMARY KEY, product_id INTEGER not null, product_name VARCHAR(100) not null, user_name VARCHAR(100), mail VARCHAR(100) not null, address VARCHAR(100) not null, phone VARCHAR(40) not null, ship_date VARCHAR(100) not null, price INTEGER not null)')\n        .then(function () {\n\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "a8f04070d73bdbf292935fc3c12faf31bd31a89ac03587c8f20c27e8ed2b7473",
            "glog-pfp-ruleFileCode/v1": "e0abc57c7bc06d5d1f60b21c34e80d202c310868f42ea3a3c74c4de05f21d8c5"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "e0abc57c7bc06d5d1f60b21c34e80d202c310868f42ea3a3c74c4de05f21d8c5"
          },
          "properties": {}
        },
        {
          "ruleId": "805b4f7c-6101-3977-a41a-a2dec383ea53",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 30,
                  "startColumn": 17,
                  "endLine": 30,
                  "endColumn": 45,
                  "snippet": {
                    "text": "            <td><%- products[i].ship_date %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "3be3dfc29c1c4a7c6da458f7c06cc8e2c51825357d9caee4073734881826b751",
            "glog-pfp-ruleFileCode/v1": "6a90e80c0d892a2351b7bb6c63714f8bb976f8766ceb7c77bba72ae51e73398e"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "6a90e80c0d892a2351b7bb6c63714f8bb976f8766ceb7c77bba72ae51e73398e"
          },
          "properties": {}
        },
        {
          "ruleId": "aed8664a-9651-3c61-95e7-f3f542acfcab",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/layout.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 1,
                  "endLine": 37,
                  "endColumn": 10,
                  "snippet": {
                    "text": "<%-body%>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "d86908247ba368981a19f822bedab826daee18b336cdec1db6e0b2a3645b2590",
            "glog-pfp-ruleFileCode/v1": "d350cbae974a0bd75dfb34996505390cb78096e7dae5b920efb465e7ccda8e0e"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "d350cbae974a0bd75dfb34996505390cb78096e7dae5b920efb465e7ccda8e0e"
          },
          "properties": {}
        },
        {
          "ruleId": "3b0b252d-5ac4-3ff3-a541-0cf12d17c691",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 31,
                  "startColumn": 17,
                  "endLine": 31,
                  "endColumn": 43,
                  "snippet": {
                    "text": "            <td><%- products[i].address %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "ac12d4b88ab6c399d51b507efdece9d92c1cf41df680c86d29a358ccaaa8b3d3",
            "glog-pfp-ruleFileCode/v1": "b69c4bc89cb64a9e7c587cb12ecaaf889a99a600a12a54f00d0685cb2d46aa4b"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "b69c4bc89cb64a9e7c587cb12ecaaf889a99a600a12a54f00d0685cb2d46aa4b"
          },
          "properties": {}
        },
        {
          "ruleId": "a45d3813-a28c-36a0-b088-4cab93d02328",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 5,
                  "endLine": 46,
                  "endColumn": 76,
                  "snippet": {
                    "text": "    var q = \"SELECT * FROM purchases WHERE user_name = '\" + username + \"';\";"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "36f29f1cab117f8f89bc26eb28fa2bf274d786960715d55c3ef81f5b51bd55b1",
            "glog-pfp-ruleFileCode/v1": "21feeab72e1063707cf1d180c50a26ec5f1827da6a3c622f4b5b1d85750299d0"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "21feeab72e1063707cf1d180c50a26ec5f1827da6a3c622f4b5b1d85750299d0"
          },
          "properties": {}
        },
        {
          "ruleId": "9c4cd823-9136-3b26-82e1-9e7e4b04aa4f",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Potential XSS Vulnerability from User-Controlled Data in HTML String\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "model/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 29,
                  "startColumn": 5,
                  "endLine": 38,
                  "endColumn": 18,
                  "snippet": {
                    "text": "    var q = \"INSERT INTO purchases(mail, product_name, user_name, product_id, address, phone, ship_date, price) VALUES('\" +\n            cart.mail + \"', '\" +\n            cart.product_name + \"', '\" +\n            cart.username + \"', '\" +\n            cart.product_id + \"', '\" +\n            cart.address + \"', '\" +\n            cart.ship_date + \"', '\" +\n            cart.phone + \"', '\" +\n            cart.price +\n            \"');\";"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "54d1a13569412fb2bf52ede234f29937f55d9acef0738a0501cb064540bc9f2c",
            "glog-pfp-ruleFileCode/v1": "ac91c02c3a965c5631be70ba54831a40df92fe520b2270ac2cea69f3950f783d"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "ac91c02c3a965c5631be70ba54831a40df92fe520b2270ac2cea69f3950f783d"
          },
          "properties": {}
        },
        {
          "ruleId": "41019249-7fa3-3799-9cc8-937413eefa84",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/bought_products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 17,
                  "endLine": 32,
                  "endColumn": 41,
                  "snippet": {
                    "text": "            <td><%- products[i].price %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "33c077c3450ffcd5c19751c64630ce139afa9707ec30ce6af2ad040888b109c6",
            "glog-pfp-ruleFileCode/v1": "90844cdcc76739d27bc153dc2adf96588fb0198254cfaf0838519d9cc99792d2"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "90844cdcc76739d27bc153dc2adf96588fb0198254cfaf0838519d9cc99792d2"
          },
          "properties": {}
        },
        {
          "ruleId": "ee07ba45-c1e9-37f0-b3f4-cf26cc0e40e0",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/content.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 5,
                  "endLine": 52,
                  "endColumn": 14,
                  "snippet": {
                    "text": "    <%-body%>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "d629422828b7269ab34ea5f45cde7746ae9c59031f3e1794d8d533518779b520",
            "glog-pfp-ruleFileCode/v1": "77a6f5812e978ac54ad4fbc15d1b4e600e90281642a0dc61f60c2f9ccfa5cac0"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "77a6f5812e978ac54ad4fbc15d1b4e600e90281642a0dc61f60c2f9ccfa5cac0"
          },
          "properties": {}
        },
        {
          "ruleId": "b8f3e78a-fec3-34a1-8a62-032be16facc2",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'Get' requests managed by '/login' HTTP route in Express."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 1,
                  "endLine": 15,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.get('/login', function(req, res, next) {\n\n    var url_params = url.parse(req.url, true).query;\n\n    res.render('login', {returnurl: url_params.returnurl, auth_error: url_params.error});\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "62e5f9e03c3787641bfd1dcba3b6f7cb7b9c6b8543265a5f930e7807910f9d2f",
            "glog-pfp-ruleFileCode/v1": "eb13dfc66570dbabe35b41196d12c87114a2c3d9c0e4e8414cc61016387cec90"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "eb13dfc66570dbabe35b41196d12c87114a2c3d9c0e4e8414cc61016387cec90"
          },
          "properties": {}
        },
        {
          "ruleId": "a578538d-e4b5-3d53-b8a7-c838e34aa714",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/login.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 17,
                  "startColumn": 94,
                  "endLine": 17,
                  "endColumn": 108,
                  "snippet": {
                    "text": "            <input type=\"hidden\" id=\"returnurl\" class=\"form-control\" name=\"returnurl\" value=\"<%-returnurl%>\">"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "be3b43e0251d6709cc4031799c685e5a83bbdcdb7348762131d691d76259f71d",
            "glog-pfp-ruleFileCode/v1": "ca8da7b9e4bf8885997a58a1224992e110f9661d18ceb0e1ec342f741d00daa2"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "ca8da7b9e4bf8885997a58a1224992e110f9661d18ceb0e1ec342f741d00daa2"
          },
          "properties": {}
        },
        {
          "ruleId": "cffc779b-f372-3e1c-a2fb-3103747f3b04",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Post requests will be managed by '/login/auth' HTTP route in Express."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 19,
                  "startColumn": 1,
                  "endLine": 42,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.post('/login/auth', function(req, res) {\n\n    var user = req.body.username;\n    var password = req.body.password;\n    var returnurl = req.body.returnurl;\n\n    logger.error(\"Tried to login attempt from user = \" + user);\n\n    auth(user, password)\n        .then(function (data) {\n            req.session.logged = true;\n            req.session.user_name = user;\n\n            if (returnurl == undefined || returnurl == \"\"){\n                returnurl = \"/\";\n            }\n\n            res.redirect(returnurl);\n        })\n        .catch(function (err) {\n            res.redirect(\"/login?returnurl=\" + returnurl + \"&error=\" + err.message);\n        });\n\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "c441297bbbf316deeeac92d56cc3a94eaa3577def85f199cc24caa05dc6fa657",
            "glog-pfp-ruleFileCode/v1": "d0547188f077cebe6b4e009e4f07c95e75a35631316df3c17c92458d8f2cedbc"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "d0547188f077cebe6b4e009e4f07c95e75a35631316df3c17c92458d8f2cedbc"
          },
          "properties": {}
        },
        {
          "ruleId": "901d0f96-814f-34dc-8ab0-5b556a5e7752",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/login.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 22,
                  "startColumn": 46,
                  "endLine": 22,
                  "endColumn": 61,
                  "snippet": {
                    "text": "            <span class=\"label label-danger\"><%-auth_error%></span>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "d75c4a2171ceb831849adbde3ddc9697a8a5786954050f7dc0e5610740a17c68",
            "glog-pfp-ruleFileCode/v1": "a8eab8aae691c598cde475c6727f4cc9166684d5ef52ec052290fec60813cd57"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "a8eab8aae691c598cde475c6727f4cc9166684d5ef52ec052290fec60813cd57"
          },
          "properties": {}
        },
        {
          "ruleId": "b92355d1-8fbf-3e21-a1e2-8b6f2ffe63fe",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 8,
                  "startColumn": 54,
                  "endLine": 8,
                  "endColumn": 74,
                  "snippet": {
                    "text": "            <img class=\"img-responsive\" src=\"/images/<%- product.image %>\" alt=\"\">"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "008cdb24fc6ccd8b01ea951eb945b7fea1341ee6eb4362e716e4d6b62307fc5a",
            "glog-pfp-ruleFileCode/v1": "827783c6c4b0513e6a40250f383ba2426660a1f2ac7bf7417f7de412149852cd"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "827783c6c4b0513e6a40250f383ba2426660a1f2ac7bf7417f7de412149852cd"
          },
          "properties": {}
        },
        {
          "ruleId": "f040fdd4-1f86-37e7-a1a5-67da2fa40546",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 10,
                  "startColumn": 40,
                  "endLine": 10,
                  "endColumn": 60,
                  "snippet": {
                    "text": "                <h4 class=\"pull-right\"><%- product.price %> </h4>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "2a329f6a7c778477958d1023b2fd0bed592d88c7aed1aeb178f1a042c7495a7a",
            "glog-pfp-ruleFileCode/v1": "e02f3d4be64ebf0378230342dc8e72a63eb3f4191272e03d6f4b46b310dcd594"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "e02f3d4be64ebf0378230342dc8e72a63eb3f4191272e03d6f4b46b310dcd594"
          },
          "properties": {}
        },
        {
          "ruleId": "5b0bc7e4-496e-3053-ba40-a2a215b22f12",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 27,
                  "startColumn": 5,
                  "endLine": 37,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    auth(user, password)\n        .then(function (data) {\n            req.session.logged = true;\n            req.session.user_name = user;\n\n            if (returnurl == undefined || returnurl == \"\"){\n                returnurl = \"/\";\n            }\n\n            res.redirect(returnurl);\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "aec378d2ec164a06b6978bf5e75f849d3825bede976441012bffbd4e8cbe8261",
            "glog-pfp-ruleFileCode/v1": "1b4412a4edbab7dbc844324a743112a4c42d3bc57d1c735da61e5d0f3b0de822"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "1b4412a4edbab7dbc844324a743112a4c42d3bc57d1c735da61e5d0f3b0de822"
          },
          "properties": {}
        },
        {
          "ruleId": "b97f985f-8494-35f3-bdb2-e522205caa11",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'Get' requests managed by '/logout' HTTP route in Express"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 1,
                  "endLine": 51,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.get('/logout', function(req, res, next) {\n\n    req.session.logged = false;\n    req.session.user = null;\n\n    res.redirect(\"/login\")\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "87332bb92eaf8e98891d7613b79f51f1bf11fe0cdfbcd54d5466b4725752475d",
            "glog-pfp-ruleFileCode/v1": "f7461790f1f674cd0ed4aea826377ff73b98466e0015765abfd5c319c36a8b7f"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "f7461790f1f674cd0ed4aea826377ff73b98466e0015765abfd5c319c36a8b7f"
          },
          "properties": {}
        },
        {
          "ruleId": "aab1f37c-9ec7-3509-a7b0-5d16d67c9eab",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 11,
                  "startColumn": 33,
                  "endLine": 11,
                  "endColumn": 50,
                  "snippet": {
                    "text": "                <h4><a href=\"#\"><%-product.name%> </a></h4>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "a07509c738da8921e1e11c7ecf0f11fe89a6a85b6cda012d343a865c4fcbed23",
            "glog-pfp-ruleFileCode/v1": "a21bfd57d6a092c05574efac18a3da5c30015759576428f888d8d66c79d4f0a4"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "a21bfd57d6a092c05574efac18a3da5c30015759576428f888d8d66c79d4f0a4"
          },
          "properties": {}
        },
        {
          "ruleId": "7ce90906-10b6-3506-9d7d-1ce0ed41d02d",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 48,
                  "startColumn": 100,
                  "endLine": 48,
                  "endColumn": 120,
                  "snippet": {
                    "text": "                            <input type=\"text\" class=\"form-control\" name=\"price\" id=\"price\" value=\"<%- product.price %>\" readonly>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "7632baa9c9660fdd077e21652c3a8109889544c9f57907bee08b7b6889a9fd79",
            "glog-pfp-ruleFileCode/v1": "54877e906cfd3aa9494fc2677cf4626d6449f54b27729e0fac7b50adb1d1416a"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "54877e906cfd3aa9494fc2677cf4626d6449f54b27729e0fac7b50adb1d1416a"
          },
          "properties": {}
        },
        {
          "ruleId": "911a0992-8cf2-3177-a921-e93da1a121ca",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "XSS Vulnerability in User-Controlled HTML Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login_check.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 6,
                  "startColumn": 9,
                  "endLine": 6,
                  "endColumn": 53,
                  "snippet": {
                    "text": "        res.redirect(\"/login?returnurl=\" + req.url);"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "e0b9122c0805df879939383738098ea8c556e62f11128026e3829277ee3b7946",
            "glog-pfp-ruleFileCode/v1": "12dc8bdfd2408b617e44fcef0cbd4286704ac520140d8f85127c7083e71a95ab"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "12dc8bdfd2408b617e44fcef0cbd4286704ac520140d8f85127c7083e71a95ab"
          },
          "properties": {}
        },
        {
          "ruleId": "f3c56ed7-8c0a-3776-afc8-166b2bc520ff",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 12,
                  "startColumn": 20,
                  "endLine": 12,
                  "endColumn": 44,
                  "snippet": {
                    "text": "                <p><%-product.description%> </p>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "1b19e6d1b2306c7021324bff4adcf404da3638c25d1a620d44483b0b82d1945c",
            "glog-pfp-ruleFileCode/v1": "9bb15996fd589d48b503a27945dddfff074f078607309b4f679639acd8e1af63"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "9bb15996fd589d48b503a27945dddfff074f078607309b4f679639acd8e1af63"
          },
          "properties": {}
        },
        {
          "ruleId": "d4714d13-9142-329f-b7e1-989015bad18f",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 16,
                  "startColumn": 46,
                  "endLine": 16,
                  "endColumn": 61,
                  "snippet": {
                    "text": "                <a href=\"/products/detail?id=<%-product.id%>\"><img src=\"/images/<%-product.image%>\" alt=\"\"></a>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "4e8786d8da0a30fe3d48c6cd852e52a7bea278139c2881a6babc7643a042c3c2",
            "glog-pfp-ruleFileCode/v1": "e8c347b048bc941290f75694579911c60c5d40676a60e2239e138ddfaa11f808"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "e8c347b048bc941290f75694579911c60c5d40676a60e2239e138ddfaa11f808"
          },
          "properties": {}
        },
        {
          "ruleId": "759b9b43-ace0-3e79-b8e2-1835f41f3645",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'/' HTTP route in Express handles GET requests."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 9,
                  "startColumn": 1,
                  "endLine": 22,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.get('/', function(req, res, next) {\n\n    check_logged(req, res);\n\n    db_products.list()\n        .then(function (data) {\n            res.render('products', { products: data });\n        })\n        .catch(function (err) {\n            console.log(err);\n\n            res.render('products', { products: [] });\n        });\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "e5776c8676abd29d39a2db78dffecd904776da99cc7f8bd3a86c057f31dea7a1",
            "glog-pfp-ruleFileCode/v1": "cd9e62b1e31e98ef4de1ee9ac59efd9c6cfa69bff194c3d31174d46d19c0bbdb"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "cd9e62b1e31e98ef4de1ee9ac59efd9c6cfa69bff194c3d31174d46d19c0bbdb"
          },
          "properties": {}
        },
        {
          "ruleId": "6b00cf90-e1f9-3a5e-850c-e22e81e3d130",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Open Redirect Vulnerability due to Untrusted User Input in redirect()"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/login_check.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 6,
                  "startColumn": 9,
                  "endLine": 6,
                  "endColumn": 52,
                  "snippet": {
                    "text": "        res.redirect(\"/login?returnurl=\" + req.url);"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "96d8204d66b4a534338e1d9e52cb1874b734ff80820a9de5a37633db65d65bc7",
            "glog-pfp-ruleFileCode/v1": "83d6b11a8522110e268fd8c376787abc9adaefc853689d562b2bbd477b17ea98"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "83d6b11a8522110e268fd8c376787abc9adaefc853689d562b2bbd477b17ea98"
          },
          "properties": {}
        },
        {
          "ruleId": "5aa0b11d-6fa7-305c-91cd-35cb88cce3b8",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 50,
                  "startColumn": 108,
                  "endLine": 50,
                  "endColumn": 125,
                  "snippet": {
                    "text": "                        <input type=\"hidden\" class=\"form-control\" name=\"product_id\" id=\"product_id\" value=\"<%- product.id %>\">"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "5cbd50b88259c95c105ffd5ec14667919743d180c15021de9baa4dd4f44840ff",
            "glog-pfp-ruleFileCode/v1": "0623be18e8eab731f417c4c1f1d832b2e342f88212142d2a809d106564a555d9"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "0623be18e8eab731f417c4c1f1d832b2e342f88212142d2a809d106564a555d9"
          },
          "properties": {}
        },
        {
          "ruleId": "9d0fd56b-6a2f-33a0-80b4-adc854ddb132",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/product_detail.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 51,
                  "startColumn": 112,
                  "endLine": 51,
                  "endColumn": 131,
                  "snippet": {
                    "text": "                        <input type=\"hidden\" class=\"form-control\" name=\"product_name\" id=\"product_name\" value=\"<%- product.name %>\">"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "9631edda746f8c7a2f87e38bc6e7a7007cf26f2bcaf78a31b2f04f68c2cf4a18",
            "glog-pfp-ruleFileCode/v1": "f8ce21b55dfd8b86332adf2e41622dbf5460570353257d34d3df96f2bb942a94"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "f8ce21b55dfd8b86332adf2e41622dbf5460570353257d34d3df96f2bb942a94"
          },
          "properties": {}
        },
        {
          "ruleId": "07c0380c-aba7-30c8-aeac-b46b3c52fcbe",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "The '/products/purchased' HTTP route in Express will manage get requests."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 1,
                  "endLine": 39,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.get('/products/purchased', function(req, res, next) {\n\n    check_logged(req, res);\n\n    db_products.getPurchased(req.session.user_name)\n        .then(function (data) {\n\n            console.log(data);\n            res.render('bought_products', { products: data });\n        })\n        .catch(function (err) {\n            console.log(err);\n\n            res.render('bought_products', { products: [] });\n        });\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "533c8a7ddc310b3da0ddb292c6e7300e061ae1733dacecc18ccbb51f0ed6f584",
            "glog-pfp-ruleFileCode/v1": "720cb9f313805827cedc0ddc03e91e64b6c44beaf865802bce60aebbb5d59ffc"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "720cb9f313805827cedc0ddc03e91e64b6c44beaf865802bce60aebbb5d59ffc"
          },
          "properties": {}
        },
        {
          "ruleId": "68c1f7d8-4b69-3060-aaf9-85ccda4552a4",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 19,
                  "startColumn": 71,
                  "endLine": 19,
                  "endColumn": 88,
                  "snippet": {
                    "text": "                    <h4><a href=\"/products/detail?id=<%-product.id%>\"><%-product.name%></a>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "a4f21e219928d3cef37fc41236fdb838b2a709be504dcf32a1ec1ddae748418a",
            "glog-pfp-ruleFileCode/v1": "9a35abbc0d72d637bd1f79bb284e23706d078334d87a4441090795c21ae3d440"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "9a35abbc0d72d637bd1f79bb284e23706d078334d87a4441090795c21ae3d440"
          },
          "properties": {}
        },
        {
          "ruleId": "ec355622-fbf9-35b7-9d73-1c7912a5302f",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "The '/products/detail' HTTP route in Express will manage get requests."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 1,
                  "endLine": 58,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.get('/products/detail', function(req, res, next) {\n\n    check_logged(req, res);\n\n    var url_params = url.parse(req.url, true).query;\n\n    var product_id = url_params.id;\n\n    db_products.getProduct(product_id)\n        .then(function (data) {\n            res.render('product_detail', { product: data });\n        })\n        .catch(function (err) {\n            console.log(err);\n\n            res.render('products', { products: [] });\n        });\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "61418381fa78ad1d7d6e2894ffed2360c5d549185a3ddf78b823cdcabfeb55fc",
            "glog-pfp-ruleFileCode/v1": "591e718a1f009deed34ef57f8c23bcdc82697a487dff1c602927deb8294b62e7"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "591e718a1f009deed34ef57f8c23bcdc82697a487dff1c602927deb8294b62e7"
          },
          "properties": {}
        },
        {
          "ruleId": "dee3bc56-a5d4-3c9a-9d6f-0b6ead96db9f",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 28,
                  "startColumn": 5,
                  "endLine": 33,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db_products.getPurchased(req.session.user_name)\n        .then(function (data) {\n\n            console.log(data);\n            res.render('bought_products', { products: data });\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "7bc97be73e3f53eb4378de18ff95220f199e87d353cde174d7df031f157290e2",
            "glog-pfp-ruleFileCode/v1": "c31713279c684e36b05cc35ede97faa90efd2162db21a8bf208b4afc02f7fb67"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "c31713279c684e36b05cc35ede97faa90efd2162db21a8bf208b4afc02f7fb67"
          },
          "properties": {}
        },
        {
          "ruleId": "5febceca-57c3-3ab2-97a5-b5bcad560a47",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unescaped EJS Template Detected, Exposing Potential XSS Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 21,
                  "startColumn": 24,
                  "endLine": 21,
                  "endColumn": 48,
                  "snippet": {
                    "text": "                    <p><%-product.description%></p>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "b4e45b73d35bbca44f8388fd73e05322887cbf913efdcdb62eae97d89606b15a",
            "glog-pfp-ruleFileCode/v1": "d3b57d9e698bab1957934ffd0a25d2f7d5f480f71eabe0384baff28c6cfdcd6e"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "d3b57d9e698bab1957934ffd0a25d2f7d5f480f71eabe0384baff28c6cfdcd6e"
          },
          "properties": {}
        },
        {
          "ruleId": "651f5d73-053c-35d1-9f19-7c7d0ae98773",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "'Get' requests managed by '/products/search' HTTP route in Express."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 62,
                  "startColumn": 1,
                  "endLine": 86,
                  "endColumn": 3,
                  "snippet": {
                    "text": "router.get('/products/search', function(req, res, next) {\n\n    check_logged(req, res);\n\n    var url_params = url.parse(req.url, true).query;\n    var query = url_params.q;\n\n    if (query == undefined) {\n        res.render('search', { in_query: \"\", products: [] });\n        return;\n    }\n\n    db_products.search(query)\n        .then(function (data) {\n\n            res.render('search', { in_query: query, products: data });\n        })\n        .catch(function (err) {\n\n            console.log(err);\n\n            res.render('search', { in_query: query, products: [] });\n        });\n\n});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "19ffcd7163b9f91af3326d89ef9aeb2998cc5f2d991f3b7fdd05357f1b1fb62f",
            "glog-pfp-ruleFileCode/v1": "c06a985849e2cfab063e2e3c2dba35089620d660a5da9285c64a1886a508db3a"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "c06a985849e2cfab063e2e3c2dba35089620d660a5da9285c64a1886a508db3a"
          },
          "properties": {}
        },
        {
          "ruleId": "2daa9317-dd3f-3b67-9c9a-38c52bff7e3c",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/products.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 18,
                  "startColumn": 44,
                  "endLine": 18,
                  "endColumn": 62,
                  "snippet": {
                    "text": "                    <h4 class=\"pull-right\"><%-product.price%></h4>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "5e139a883b94b0423eadc858ef5ea8beaa1fabc659b2068836da7cbf152f5d42",
            "glog-pfp-ruleFileCode/v1": "d9a2f8773f9875630b1d860f1576b578da00d9075b3f99c0cd3c6bd7399fd15b"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "d9a2f8773f9875630b1d860f1576b578da00d9075b3f99c0cd3c6bd7399fd15b"
          },
          "properties": {}
        },
        {
          "ruleId": "77bb697b-b61c-3d01-8a4b-c0e1aadcf09b",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/search.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 3,
                  "startColumn": 18,
                  "endLine": 3,
                  "endColumn": 33,
                  "snippet": {
                    "text": "<h2>Results for: <%- in_query %></h2>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "48e26a34816293c26c0a15ba944c7d9ed54932b38473127956d2190e0d91b34f",
            "glog-pfp-ruleFileCode/v1": "652d5414ecbab8695881e665991ef2a0a6705b2437e2133de23975f2373600e5"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "652d5414ecbab8695881e665991ef2a0a6705b2437e2133de23975f2373600e5"
          },
          "properties": {}
        },
        {
          "ruleId": "444f5d48-a65a-3fcf-94a3-cbbab02c71c6",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 13,
                  "startColumn": 5,
                  "endLine": 16,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db_products.list()\n        .then(function (data) {\n            res.render('products', { products: data });\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "9183b3680d80e418039830183f4d720e94892d898ddf66c91ce7be32391fa9a5",
            "glog-pfp-ruleFileCode/v1": "92bb57486ca947b5db4a2da13af94999003ac4aebd5bf3b45e879a7ac1d80b10"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "92bb57486ca947b5db4a2da13af94999003ac4aebd5bf3b45e879a7ac1d80b10"
          },
          "properties": {}
        },
        {
          "ruleId": "c51e2121-42b6-3458-9e73-d04dc903f5fb",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "\"Exposure of Error Details Vulnerability\""
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 142,
                  "startColumn": 20,
                  "endLine": 142,
                  "endColumn": 70,
                  "snippet": {
                    "text": "            return res.json({message: \"Product purchased correctly\"});"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "8cf2cb5c3f14e5dd59cbca3530167108a3c9b01e85c0125bce4ee29785e4bcd2",
            "glog-pfp-ruleFileCode/v1": "1281d713eed6e6a428d495dd669cda2e6879d18e07762f87aa1eb7965366908b"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "1281d713eed6e6a428d495dd669cda2e6879d18e07762f87aa1eb7965366908b"
          },
          "properties": {}
        },
        {
          "ruleId": "a3213458-14c4-340c-a99b-a6d332a35ec6",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 74,
                  "startColumn": 5,
                  "endLine": 78,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db_products.search(query)\n        .then(function (data) {\n\n            res.render('search', { in_query: query, products: data });\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "f2de7fc23f8609ec2aacdb1a9314e5aa707f467ab87525ad07efe639b9b8d47b",
            "glog-pfp-ruleFileCode/v1": "4d44542a9bd3b2f379a63639314552fbcde934a06ce86571c3b29bb7d7aaa0ed"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "4d44542a9bd3b2f379a63639314552fbcde934a06ce86571c3b29bb7d7aaa0ed"
          },
          "properties": {}
        },
        {
          "ruleId": "e4feccd5-cb87-31a5-91f1-82c98fbc42a9",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/search.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 26,
                  "startColumn": 17,
                  "endLine": 26,
                  "endColumn": 41,
                  "snippet": {
                    "text": "            <td><%- products[i].price %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "cdf44bde745dd9dd77445673edcecccb5122ed2b22760e398b5746a05eae0a2d",
            "glog-pfp-ruleFileCode/v1": "3a4d8557d71adff26a3336f4e9511a3b285d7b3cd57a6c9a6546f8ea2aab596d"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "3a4d8557d71adff26a3336f4e9511a3b285d7b3cd57a6c9a6546f8ea2aab596d"
          },
          "properties": {}
        },
        {
          "ruleId": "c19f6270-1090-3260-8793-90341df3a4a7",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "Unhandled Promise Rejection Vulnerability"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "routes/products.js",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 49,
                  "startColumn": 5,
                  "endLine": 52,
                  "endColumn": 11,
                  "snippet": {
                    "text": "    db_products.getProduct(product_id)\n        .then(function (data) {\n            res.render('product_detail', { product: data });\n        })"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "e512f5a28b26712e78af1fd1db3aaeef87d178705ee50a47f3ceef0d36b47df2",
            "glog-pfp-ruleFileCode/v1": "60eab56d091842b68ca648a6d6400a71b6adfc7038c99953fac00ff1d3bed8a7"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "60eab56d091842b68ca648a6d6400a71b6adfc7038c99953fac00ff1d3bed8a7"
          },
          "properties": {}
        },
        {
          "ruleId": "53909f58-2f54-3c2d-a174-9d2ecc6a8fd4",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/search.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 23,
                  "startColumn": 17,
                  "endLine": 23,
                  "endColumn": 29,
                  "snippet": {
                    "text": "            <td><%- i + 1 %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "00a4de37af16ee8690a1917899b21acca361a855ba63f341e1a3beb368d1b841",
            "glog-pfp-ruleFileCode/v1": "1da17d8ca1585667d5eda64be447d39c109767b24bebaeaf3a756d837c9951d2"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "1da17d8ca1585667d5eda64be447d39c109767b24bebaeaf3a756d837c9951d2"
          },
          "properties": {}
        },
        {
          "ruleId": "e99dca15-8054-30dd-ab36-5b2b69d15420",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/search.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 27,
                  "startColumn": 46,
                  "endLine": 27,
                  "endColumn": 58,
                  "snippet": {
                    "text": "            <td><a href=\"/products/detail?id=<%- i + 1 %>\"><i class=\"glyphicon glyphicon-list\"></i></a></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "7582a068f3326f929420b41645cfbaffb2c6bd9fab513a1cd67bfdd4e8f10690",
            "glog-pfp-ruleFileCode/v1": "3e62eef22c4b16e816a656c7d5ff286ac576bfe95ccca8cc8068e42b39979835"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "3e62eef22c4b16e816a656c7d5ff286ac576bfe95ccca8cc8068e42b39979835"
          },
          "properties": {}
        },
        {
          "ruleId": "bb6ea644-4322-345f-b90a-a9baf6a7ea35",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/search.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 17,
                  "endLine": 24,
                  "endColumn": 40,
                  "snippet": {
                    "text": "            <td><%- products[i].name %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "a27f5c1114a9468fe5a33582a726666c4954c8177ba1a25b36f8fe6fbab582cf",
            "glog-pfp-ruleFileCode/v1": "5d690debfd6da0d0a8d6c8f341eab854ae3872c08a3dad0f5d104b51e32ad312"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "5d690debfd6da0d0a8d6c8f341eab854ae3872c08a3dad0f5d104b51e32ad312"
          },
          "properties": {}
        },
        {
          "ruleId": "66ed0e4d-548b-384c-830a-a4604d8a721f",
          "kind": "fail",
          "level": "warning",
          "message": {
            "text": "EJS Template XSS Vulnerability Detected Due to Unescaped External Data"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "views/search.ejs",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 25,
                  "startColumn": 17,
                  "endLine": 25,
                  "endColumn": 47,
                  "snippet": {
                    "text": "            <td><%- products[i].description %></td>"
                  }
                }
              }
            }
          ],
          "partialFingerprints": {
            "glog-pfp-ruleFileLineCode/v1": "d3a07a98411bc09ffe2220dc1c1c5d568c6e2266713cefa1e6a89a464f69dc12",
            "glog-pfp-ruleFileCode/v1": "6b738fd4d9c382870ffced14daace8d7e54e95dd655995be13960640de5707ca"
          },
          "fingerprints": {
            "glog-fp-ruleFileCode/v1": "6b738fd4d9c382870ffced14daace8d7e54e95dd655995be13960640de5707ca"
          },
          "properties": {}
        }
      ],
      "newlineSequences": [
        "\r\n",
        "\n"
      ]
    }
  ]
}